<tool id="netisce11" name="Netisce Step 11" version="0.1.0" R_template_version="3.6.3">
<description>Filters perutrbations on FVS control nodes whose steady-state values of internal-marker nodes are within the gene expression range of the desired attractor.</description>

    <requirements>
        <requirement type="package" version="1.8.6">plyr</requirement>
        <requirement type="package" version="1.0.7">dplyr</requirement>
        <requirement type="package" version="1.4.4">reshape2</requirement>
        <requirement type="package" version="2.1.1">readr</requirement>
    </requirements>
    
    <command> Rscript '$__tool_directory__/bin/crit2.R' '$exp_attrs_icn' '$samples' '$desired_state' '$undesired_state' '$filter_type' '$crit_perts' crit2_perturbations.txt</command>

    <inputs>
        <param name="exp_attrs_icn" type="data" format="txt" label="Experimental Attractors of Internal Control Markers"/>
        <param name="samples" type="data" format="txt" label="Experimental Samples"/>
        <param name="crit_perts" type="data" format="txt" label="Perturbation Attractors that shifted to a different state/cluster"/>
        <param name="desired_state" type="text" value="sensitive" label="Desired State"/>
        <param name="undesired_state" type="text" value="resistant" label="Undesired State"/>
        <param name="filter_type" label="Criterion Strictness (strict or relaxed)" type="text" value="strict"/>
        <!-- <conditional name="filter">
            <param name="strict_filter?" type="boolean" label="Choose Criterion Strictness"/>
            <when value="true">
                <param name="filter_type" label="Criterion Strictness" type="text" value="strict"/>
            </when>
            <when value="false">
                <param name="filter_type" label="Criterion Strictness" type="text" value="strict"/>
            </when>
        </conditional> -->
    </inputs>

    <outputs>
        <data name="output" format="txt" from_work_dir="crit2_perturbations.txt" label="Perturbations whose internal-marker nodes in the attractors are within the gene expression range of the desired attractor."/>
    </outputs>

    <tests>
        <test>
            <param name="exp_attrs_icn" value="exp_internalmarkers"/>
            <param name="samples" value="samples.txt"/>
            <param name="crit_perts" value="internal_markers.txt"/>
            <param name="desired_state" value="sensitive"/>
            <param name="undesired state" value="resistant"/>
            <param name="strict_filter?" value="true"/>
            <output name="output" value="crit2_perturbations.txt" ftype="txt" />
        </test>
    </tests>
    
    <help>
    This tool Filters perutrbations on FVS control nodes whose steady-state values of internal-marker nodes are within the gene expression range of the desired attractor.
    Required Inputs:
    1. Experimental Attractors of Internal Control Markers
    2. Experimental Samples of Interest
    3. Perturbation Attractors that shifted to a different state/cluster
    4. Sample Name of Desired State
    5. Sample Name of Undesired State
    6. Strict or Relaxed Criterion
    </help>

</tool>