<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Adaptive Resistance in Colorectal Cancer Example | NETISCE Manual and Tutorials</title>
  <meta name="description" content="Welcome to the NETISCE manual and tutorials. NETISCE is a network-based approach for cellular reprogramming. This manual contains directions for intial setup, as well as tutorials for reproducing NETISCE cell reprogramming results in developmental, stem cell, and cancer biology." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Adaptive Resistance in Colorectal Cancer Example | NETISCE Manual and Tutorials" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://veraliconaresearchgroup.github.io/Netisce/" />
  <meta property="og:image" content="https://veraliconaresearchgroup.github.io/Netisce/images/netisce-logo.png" />
  <meta property="og:description" content="Welcome to the NETISCE manual and tutorials. NETISCE is a network-based approach for cellular reprogramming. This manual contains directions for intial setup, as well as tutorials for reproducing NETISCE cell reprogramming results in developmental, stem cell, and cancer biology." />
  <meta name="github-repo" content="https://github.com/veraliconaresearchgroup/netisce" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Adaptive Resistance in Colorectal Cancer Example | NETISCE Manual and Tutorials" />
  
  <meta name="twitter:description" content="Welcome to the NETISCE manual and tutorials. NETISCE is a network-based approach for cellular reprogramming. This manual contains directions for intial setup, as well as tutorials for reproducing NETISCE cell reprogramming results in developmental, stem cell, and cancer biology." />
  <meta name="twitter:image" content="https://veraliconaresearchgroup.github.io/Netisce/images/netisce-logo.png" />

<meta name="author" content="Lauren Marazzi" />


<meta name="date" content="2022-06-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pluripotent-stem-cell-example.html"/>
<link rel="next" href="evaluating-the-robustness-to-noise-of-netisce.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">NETISCE manual and tutorials</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="chapter" data-level="2" data-path="installation-and-usage.html"><a href="installation-and-usage.html"><i class="fa fa-check"></i><b>2</b> Installation and Usage</a><ul>
<li class="chapter" data-level="2.1" data-path="installation-and-usage.html"><a href="installation-and-usage.html#download-netisce"><i class="fa fa-check"></i><b>2.1</b> Download NETISCE</a></li>
<li class="chapter" data-level="2.2" data-path="installation-and-usage.html"><a href="installation-and-usage.html#install-nextflow"><i class="fa fa-check"></i><b>2.2</b> Install Nextflow</a></li>
<li class="chapter" data-level="2.3" data-path="installation-and-usage.html"><a href="installation-and-usage.html#prerequisuites"><i class="fa fa-check"></i><b>2.3</b> Prerequisuites</a></li>
<li class="chapter" data-level="2.4" data-path="installation-and-usage.html"><a href="installation-and-usage.html#docker-image"><i class="fa fa-check"></i><b>2.4</b> Docker Image</a></li>
<li class="chapter" data-level="2.5" data-path="installation-and-usage.html"><a href="installation-and-usage.html#params"><i class="fa fa-check"></i><b>2.5</b> Parameters and Configuration</a><ul>
<li class="chapter" data-level="2.5.1" data-path="installation-and-usage.html"><a href="installation-and-usage.html#netisce_mutations.nf"><i class="fa fa-check"></i><b>2.5.1</b> NETISCE_mutations.nf</a></li>
<li class="chapter" data-level="2.5.2" data-path="installation-and-usage.html"><a href="installation-and-usage.html#nextflow.config"><i class="fa fa-check"></i><b>2.5.2</b> nextflow.config</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="installation-and-usage.html"><a href="installation-and-usage.html#running-netisce"><i class="fa fa-check"></i><b>2.6</b> Running NETISCE</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="netisce-output.html"><a href="netisce-output.html"><i class="fa fa-check"></i><b>3</b> NETISCE output</a></li>
<li class="chapter" data-level="4" data-path="toy.html"><a href="toy.html"><i class="fa fa-check"></i><b>4</b> Toy Network Examples</a><ul>
<li class="chapter" data-level="4.1" data-path="toy.html"><a href="toy.html#overview"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="toy.html"><a href="toy.html#data"><i class="fa fa-check"></i><b>4.2</b> Data</a></li>
<li class="chapter" data-level="4.3" data-path="toy.html"><a href="toy.html#netisce-run-configuration"><i class="fa fa-check"></i><b>4.3</b> NETISCE run configuration</a></li>
<li class="chapter" data-level="4.4" data-path="toy.html"><a href="toy.html#run-netisce"><i class="fa fa-check"></i><b>4.4</b> Run NETISCE</a></li>
<li class="chapter" data-level="4.5" data-path="toy.html"><a href="toy.html#netsice-results"><i class="fa fa-check"></i><b>4.5</b> NETSICE Results</a></li>
<li class="chapter" data-level="4.6" data-path="toy.html"><a href="toy.html#toy-example-with-mutations"><i class="fa fa-check"></i><b>4.6</b> Toy Example with mutations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cell-fate-specification-in-ascidian-embryo.html"><a href="cell-fate-specification-in-ascidian-embryo.html"><i class="fa fa-check"></i><b>5</b> Cell Fate Specification in Ascidian Embryo</a><ul>
<li class="chapter" data-level="5.1" data-path="cell-fate-specification-in-ascidian-embryo.html"><a href="cell-fate-specification-in-ascidian-embryo.html#input-data"><i class="fa fa-check"></i><b>5.1</b> Input Data</a></li>
<li class="chapter" data-level="5.2" data-path="cell-fate-specification-in-ascidian-embryo.html"><a href="cell-fate-specification-in-ascidian-embryo.html#run-the-simulation"><i class="fa fa-check"></i><b>5.2</b> Run the simulation</a></li>
<li class="chapter" data-level="5.3" data-path="cell-fate-specification-in-ascidian-embryo.html"><a href="cell-fate-specification-in-ascidian-embryo.html#results"><i class="fa fa-check"></i><b>5.3</b> Results</a></li>
<li class="chapter" data-level="5.4" data-path="cell-fate-specification-in-ascidian-embryo.html"><a href="cell-fate-specification-in-ascidian-embryo.html#visualizing-results"><i class="fa fa-check"></i><b>5.4</b> Visualizing Results</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="pluripotent-stem-cell-example.html"><a href="pluripotent-stem-cell-example.html"><i class="fa fa-check"></i><b>6</b> Pluripotent Stem Cell Example</a><ul>
<li class="chapter" data-level="6.1" data-path="pluripotent-stem-cell-example.html"><a href="pluripotent-stem-cell-example.html#input-data-1"><i class="fa fa-check"></i><b>6.1</b> Input Data</a></li>
<li class="chapter" data-level="6.2" data-path="pluripotent-stem-cell-example.html"><a href="pluripotent-stem-cell-example.html#run-the-simulation-1"><i class="fa fa-check"></i><b>6.2</b> Run the simulation</a></li>
<li class="chapter" data-level="6.3" data-path="pluripotent-stem-cell-example.html"><a href="pluripotent-stem-cell-example.html#results-1"><i class="fa fa-check"></i><b>6.3</b> Results</a><ul>
<li class="chapter" data-level="6.3.1" data-path="pluripotent-stem-cell-example.html"><a href="pluripotent-stem-cell-example.html#general-results"><i class="fa fa-check"></i><b>6.3.1</b> General Results</a></li>
<li class="chapter" data-level="6.3.2" data-path="pluripotent-stem-cell-example.html"><a href="pluripotent-stem-cell-example.html#results-using-4-internal-marker-nodes"><i class="fa fa-check"></i><b>6.3.2</b> Results using 4 internal-marker nodes</a></li>
<li class="chapter" data-level="6.3.3" data-path="pluripotent-stem-cell-example.html"><a href="pluripotent-stem-cell-example.html#results-using-7-internal-marker-nodes"><i class="fa fa-check"></i><b>6.3.3</b> Results using 7 internal-marker nodes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="adaptive-resistance-in-colorectal-cancer-example.html"><a href="adaptive-resistance-in-colorectal-cancer-example.html"><i class="fa fa-check"></i><b>7</b> Adaptive Resistance in Colorectal Cancer Example</a><ul>
<li class="chapter" data-level="7.1" data-path="adaptive-resistance-in-colorectal-cancer-example.html"><a href="adaptive-resistance-in-colorectal-cancer-example.html#input-data-2"><i class="fa fa-check"></i><b>7.1</b> Input Data</a></li>
<li class="chapter" data-level="7.2" data-path="adaptive-resistance-in-colorectal-cancer-example.html"><a href="adaptive-resistance-in-colorectal-cancer-example.html#run-the-simulation-2"><i class="fa fa-check"></i><b>7.2</b> Run the simulation</a></li>
<li class="chapter" data-level="7.3" data-path="adaptive-resistance-in-colorectal-cancer-example.html"><a href="adaptive-resistance-in-colorectal-cancer-example.html#results-2"><i class="fa fa-check"></i><b>7.3</b> Results</a><ul>
<li class="chapter" data-level="7.3.1" data-path="adaptive-resistance-in-colorectal-cancer-example.html"><a href="adaptive-resistance-in-colorectal-cancer-example.html#general-results-1"><i class="fa fa-check"></i><b>7.3.1</b> General Results</a></li>
<li class="chapter" data-level="7.3.2" data-path="adaptive-resistance-in-colorectal-cancer-example.html"><a href="adaptive-resistance-in-colorectal-cancer-example.html#results-using-3-internal-marker-nodes"><i class="fa fa-check"></i><b>7.3.2</b> Results using 3 internal-marker nodes</a></li>
<li class="chapter" data-level="7.3.3" data-path="adaptive-resistance-in-colorectal-cancer-example.html"><a href="adaptive-resistance-in-colorectal-cancer-example.html#results-using-apoptosis-proliferation-and-mapk-signaling-internal-marker-nodes"><i class="fa fa-check"></i><b>7.3.3</b> Results using apoptosis, proliferation, and MAPK signaling internal-marker nodes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="evaluating-the-robustness-to-noise-of-netisce.html"><a href="evaluating-the-robustness-to-noise-of-netisce.html"><i class="fa fa-check"></i><b>8</b> Evaluating the Robustness to Noise of NETISCE</a><ul>
<li class="chapter" data-level="8.1" data-path="evaluating-the-robustness-to-noise-of-netisce.html"><a href="evaluating-the-robustness-to-noise-of-netisce.html#copasi-simualtions-of-mathematical-models"><i class="fa fa-check"></i><b>8.1</b> COPASI simualtions of mathematical models</a><ul>
<li class="chapter" data-level="8.1.1" data-path="evaluating-the-robustness-to-noise-of-netisce.html"><a href="evaluating-the-robustness-to-noise-of-netisce.html#von-dassows-drosophila-segment-polarity-gene-model"><i class="fa fa-check"></i><b>8.1.1</b> von Dassow’s Drosophila Segment Polarity Gene model</a></li>
<li class="chapter" data-level="8.1.2" data-path="evaluating-the-robustness-to-noise-of-netisce.html"><a href="evaluating-the-robustness-to-noise-of-netisce.html#zhou-cell-fate-specification-model"><i class="fa fa-check"></i><b>8.1.2</b> Zhou Cell Fate Specification model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="evaluating-the-robustness-to-noise-of-netisce.html"><a href="evaluating-the-robustness-to-noise-of-netisce.html#noisy-initial-states-files"><i class="fa fa-check"></i><b>8.2</b> Noisy initial states files</a></li>
<li class="chapter" data-level="8.3" data-path="evaluating-the-robustness-to-noise-of-netisce.html"><a href="evaluating-the-robustness-to-noise-of-netisce.html#running-the-netisce-simulations"><i class="fa fa-check"></i><b>8.3</b> Running the NETISCE simulations</a><ul>
<li class="chapter" data-level="8.3.1" data-path="evaluating-the-robustness-to-noise-of-netisce.html"><a href="evaluating-the-robustness-to-noise-of-netisce.html#drosophila-noise-studies-at-40-noise-in-initial-states"><i class="fa fa-check"></i><b>8.3.1</b> Drosophila noise studies at 40% noise in initial states</a></li>
<li class="chapter" data-level="8.3.2" data-path="evaluating-the-robustness-to-noise-of-netisce.html"><a href="evaluating-the-robustness-to-noise-of-netisce.html#pancreas-cell-fate-specification-at-10-noise-in-initial-states"><i class="fa fa-check"></i><b>8.3.2</b> Pancreas cell fate specification at 10% noise in initial states</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="netisce-in-galaxy-project.html"><a href="netisce-in-galaxy-project.html"><i class="fa fa-check"></i><b>9</b> NETISCE in Galaxy Project</a><ul>
<li class="chapter" data-level="9.1" data-path="netisce-in-galaxy-project.html"><a href="netisce-in-galaxy-project.html#installing-galaxy"><i class="fa fa-check"></i><b>9.1</b> Installing Galaxy</a></li>
<li class="chapter" data-level="9.2" data-path="netisce-in-galaxy-project.html"><a href="netisce-in-galaxy-project.html#installing-the-netisce-tool-from-galaxy-tool-shed."><i class="fa fa-check"></i><b>9.2</b> Installing the NETISCE tool from Galaxy Tool Shed.</a></li>
<li class="chapter" data-level="9.3" data-path="netisce-in-galaxy-project.html"><a href="netisce-in-galaxy-project.html#downloading-the-netisce-workflow."><i class="fa fa-check"></i><b>9.3</b> Downloading the NETISCE workflow.</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NETISCE Manual and Tutorials</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="adaptive-resistance-in-colorectal-cancer-example" class="section level1">
<h1><span class="header-section-number">7</span> Adaptive Resistance in Colorectal Cancer Example</h1>
<p>This section contains instructions to reproduce the results of simulating perturbations on FVS control nodes in a network of colorectal cancer (CRC) signaling pathways. The goal of these simulations is to identify targets that can reprogram cells from a MAPK inhibitor therapy resistant phenotype to the MAPK inhibitor therapy sensitive fate. You can read the original report here: link</p>
<p>The original study of reversion of resistance to MAPKi therapy was performed by Park et al. in “<a href="https://www.nature.com/articles/s41388-020-1255-y">Feedback analysis identifies a combination target for overcoming adaptive resistance to targeted cancer therapy (Oncogene volume 39, pages3803–3820 (2020))</a>”. The network and internal-marker nodes were extracted from the publication and its supplementary material. The normalized expression data and mutational profiles used for initial activities in NETISCE was downloaded from the Cancer Cell Line Encyclopedia from<a href="https://depmap.org/portal/cell_line/ACH-000552?tab=mutation">The Cancer Dependency Map</a>.</p>
<p>The input data, nextflow pipeline, and results of this simulation can be found in the <a href="https://github.com/VeraLiconaResearchGroup/Netisce/tree/main/colorectal_cancer_validation">colorectal_cancer_validation folder</a> in the NETISCE github repository</p>
<div id="input-data-2" class="section level2">
<h2><span class="header-section-number">7.1</span> Input Data</h2>
<p><a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/colorectal_cancer_validation/input_data/network.sif"><code>network.sif</code></a> contains the network structure for CRC signaling</p>
<p><a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/colorectal_cancer_validation/input_data/expression.csv"><code>expression.csv</code></a> contains the initial activities for HT29 untreated cells. The columns for H29_BRAFi (MAPK inhibitor therapy resistant state) and H29_BRAFi+EGRFi (MAPK inhibitor therapy sensitive state) are copies of the HT29 column</p>
<p><a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/colorectal_cancer_validation/input_data/internal-marker-1.txt"><code>internal-marker-1.txt</code></a> contains the 3 internal marker nodes that were originally used in Park et al., to evaluate simulations.</p>
<p><a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/colorectal_cancer_validation/input_data/internal-marker-apoptosis.txt"><code>internal-marker-apoptosis.txt</code></a> contains the internal marker nodes related to apoptosis used to evaluate simulations.</p>
<p><a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/colorectal_cancer_validation/input_data/internal-marker-mapk.txt"><code>internal-marker-mapk.txt</code></a> contains the internal marker nodes related to mapk used to evaluate simulations.</p>
<p><a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/colorectal_cancer_validation/input_data/internal-marker-proliferation.txt"><code>internal-marker-proliferation.txt</code></a> contains the internal marker nodes related to proliferation used to evaluate simulations.</p>
<p><a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/colorectal_cancer_validation/input_data/samples.txt"><code>samples.txt</code></a> contains they key for NETISCE to associate certain samples to the phenotypes of untreated (HT29), resistant (HT29_BRAFi), and sensitive (HT29_BRAFiEGFRi)</p>
<p><a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/colorectal_cancer_validation/input_data/mutations.csv"><code>mutations.csv</code></a> mutational profile of HT29 cells, as well as the overrides for simulating BRAFi and EGRFi.</p>
</div>
<div id="run-the-simulation-2" class="section level2">
<h2><span class="header-section-number">7.2</span> Run the simulation</h2>
<p>These simulations were run on a high performance cluster that uses a SLURM executor. If your hpc uses a different executor, please update those specifications in the <code>nextflow.config</code> file in the directory. Please see <a href="https://www.nextflow.io/docs/latest/config.html" class="uri">https://www.nextflow.io/docs/latest/config.html</a> for more information regarding your executor.</p>
<p>For ease of reproduction, we have included all files necessary to reproduce the reported results directly in the <a href="https://github.com/VeraLiconaResearchGroup/Netisce/tree/main/colorectal_cancer_validation">directory</a>. We highly recommend you run this simulation on an hpc, as you will be generating files of 3Gb+. We have included the <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/colorectal_cancer_validation/run.sh">bash file</a> we used on our SLURM executor.</p>
<p><strong>Note: </strong> within the <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/colorectal_cancer_validation/NETISCE_mutations.nf"><code>NETISCE_mutations.nf</code></a> configuration file, you will want to change the params.internal_control line if you want to use a different set of internal-marker nodes.</p>
<pre><code>#!/usr/bin/env nextflow

params.expressions = &quot;$baseDir/input_data/expression.csv&quot;
params.network = &quot;$baseDir/input_data/network.sif&quot;
params.samples = &quot;$baseDir/input_data/samples.txt&quot;
params.internal_control=&quot;$baseDir/input_data/internal-marker-1.txt&quot;
params.mutations=&quot;$baseDir/input_data/mutations.csv&quot;
params.alpha = 0.9
params.undesired = &#39;resistant&#39;
params.desired = &#39;sensitive&#39;
params.filter =&quot;strict&quot;
</code></pre>
<p>As discussed in our paper, we filtered the perturbations using the original 3 internal-marker nodes for apoptosis, proliferation, and MAPK signaling. We further filtered perturbations on the FVS control nodes using 17 addition internal-marker nodes, related to the phenotypes of apoptosis, proliferation, and MAPK signaling. Therefore, to use a set of internal-marker nodes, please point to the correct input-data file. We created folders within the <code>results</code> folder to house the relevant internal-marker node files for each set. You may want to do the same as to not overwrite them (or move them into a separate folder). Additionally, when you run the nextflow command, <strong>please be sure to use the <code>-resume</code> flag so that you use the cached computations that do not need to be re-computed</strong></p>
<p>You can run NETISCE directly from this folder using the following command: <code>./nextflow run NETISC_mutations.nf -resume</code></p>
</div>
<div id="results-2" class="section level2">
<h2><span class="header-section-number">7.3</span> Results</h2>
<p>Herein, we will focus on the results that are deposited in the <a href="https://github.com/VeraLiconaResearchGroup/Netisce/tree/main/colorectal_cancer_validation/results"><code>results</code></a> folder by NETISCE. However, each step of the nextflow pipeline produces its corresponding raw results (for example, the entire attractor state for network simulations initialized with experimental data). If you are interested in looking at those raw results, they can be found within the <a href="https://github.com/VeraLiconaResearchGroup/Netisce/tree/main/colorectal_cancer_validation/work"><code>work</code></a> folder. We provide <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/colorectal_cancer_validation/work/workfiles.txt"><code>workfiles.txt</code></a> which is a guide to which folders/subfolders contain the relevant results of each step.</p>
<div id="general-results-1" class="section level3">
<h3><span class="header-section-number">7.3.1</span> General Results</h3>
<p>First, let’s take a look at the results that do not depend on the internal-marker node set.</p>
<div id="section-id" class="section level4 unnumbered">
<h4>FVS finding</h4>
Here we focus on one of the FVSes in the network, which we call, Set 1.
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
AKT1
</td>
</tr>
<tr>
<td style="text-align:left;">
CCNA1
</td>
</tr>
<tr>
<td style="text-align:left;">
CTNNB1
</td>
</tr>
<tr>
<td style="text-align:left;">
E2F1
</td>
</tr>
<tr>
<td style="text-align:left;">
GRB2
</td>
</tr>
<tr>
<td style="text-align:left;">
MAPK1
</td>
</tr>
<tr>
<td style="text-align:left;">
MAPK14
</td>
</tr>
<tr>
<td style="text-align:left;">
MAPK8
</td>
</tr>
<tr>
<td style="text-align:left;">
MDM2
</td>
</tr>
<tr>
<td style="text-align:left;">
PDK1
</td>
</tr>
<tr>
<td style="text-align:left;">
SMAD7
</td>
</tr>
<tr>
<td style="text-align:left;">
SRC
</td>
</tr>
<tr>
<td style="text-align:left;">
TP53
</td>
</tr>
<tr>
<td style="text-align:left;">
TSC1
</td>
</tr>
</tbody>
</table>
<p>Set 1 contains 14 nodes. Notice that TP53 is included in the FVS. This is a mutant gene in HT29 cells. NETISCE_mutations automatically filters out mutated genes, and places the FVS without mutated genes in the <code>fvs-no-mutated-genes.txt</code> file.</p>
and we remove mutated genes!
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
AKT1
</td>
</tr>
<tr>
<td style="text-align:left;">
CCNA1
</td>
</tr>
<tr>
<td style="text-align:left;">
CTNNB1
</td>
</tr>
<tr>
<td style="text-align:left;">
E2F1
</td>
</tr>
<tr>
<td style="text-align:left;">
GRB2
</td>
</tr>
<tr>
<td style="text-align:left;">
MAPK1
</td>
</tr>
<tr>
<td style="text-align:left;">
MAPK14
</td>
</tr>
<tr>
<td style="text-align:left;">
MAPK8
</td>
</tr>
<tr>
<td style="text-align:left;">
MDM2
</td>
</tr>
<tr>
<td style="text-align:left;">
PDK1
</td>
</tr>
<tr>
<td style="text-align:left;">
SMAD7
</td>
</tr>
<tr>
<td style="text-align:left;">
SRC
</td>
</tr>
<tr>
<td style="text-align:left;">
TSC1
</td>
</tr>
</tbody>
</table>
</div>
<div id="section-id" class="section level4 unnumbered">
<h4>Attractor landscape estimation via k-means analysis</h4>
<p>Now, let’s look at the results of k-means analysis. First, NETISCE determines the optimal number of k clusters by computing the elbow and silhouette metrics.</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-36"></span>
<img src="crc/results/elbow.png" alt="optimal k as identified by a) the elbow and b) silhouette metrics" width="50%" /><img src="crc/results/silhouette.png" alt="optimal k as identified by a) the elbow and b) silhouette metrics" width="50%" />
<p class="caption">
Figure 7.1: optimal k as identified by a) the elbow and b) silhouette metrics
</p>
</div>
<p>We see that the optimal k assessed by both the elbow metric and silhouette metric was k=3. NETISCE checkes to make sure that the untreated, MAPK inihibitor therapy resistant, and MAPK inhibitor therapy sensitive attractors are all separate.</p>
<p>We can look at those results in the <code>kmeans.txt</code> file.</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:right;">
clusters
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HT29
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
HT29_BRAFiEGFRi
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
HT29_BRAFi
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div id="section-id" class="section level4 unnumbered">
<h4>Pertrubations on FVS control nodes that pass criterion 1</h4>
<p>With 13 FVS control nodes, NETISCE performed 1,594,323 simulations of combinations of perturbations on the FVS control nodes. The resulting attractors were classified to the clusters produced from the k-means analysis using Naive Bayes, Support Vector Machine, and Random Forest Machine Learning classification algorithms. Then, the perturbations are filtered by which of their corresponding attractors were classified to the MAPK inhibitor therapy sensitive cluster by at least 2 of the 3 methods. These results can be found in <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/colorectal_cancer_validation/results/crit1perts.txt"><code>crit1_perts.txt</code></a>. Here we show the first 10 rows.</p>
<pre><code>## [1] &quot;number of perturbations that pass filtering criteria 1: 232114&quot;</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
pert_0
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_1
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_9
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_10
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_11
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_18
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_19
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_20
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_27
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="results-using-3-internal-marker-nodes" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Results using 3 internal-marker nodes</h3>
<p><strong>The relevant files have the prefix ‘original’ in the github repository</strong></p>
<p>Our second perturbation filtering criterion identifies perturbations where, in their corresponding attractors, 90% of the steady state values for internal-marker nodes that are within the steady state expression ranges in the attractor representing MAPK inhibitor therapy sensitivity.</p>
<p>First, let’s take a look at the steady state values of the internal-marker nodes CASP3, CCNE1, and MAPK1 in the attractors generated from the untreated HT29 with simulated BRAFi (resistant) and BRAFi+EGFRi (sensitive). The values can be found in the <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/colorectal_cancer_validation/results/3-marker-nodes/exp_internalmarkers.txt"><code>exp_internalmarkers.txt</code></a> and are plotted in <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/colorectal_cancer_validation/results/3-marker-nodes/experimental_internalmarkers.pdf"><code>-experimental_internalmarkers.pdf</code></a>:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-39"></span>
<img src="crc/results/3-marker-nodes/experimental_internalmarkers.png" alt="histograms of 3 internal-marker node values" width="350" />
<p class="caption">
Figure 7.2: histograms of 3 internal-marker node values
</p>
</div>
<p>We see that the value of the internal-marker for the apoptosis (CASP3) is higher and the steady-state values of the internal-marker nodes for proliferation (CCNE1) and MAPK signaling (MAPK1) are lower in the MAPK inhibitor therapy sensitive associated attractor than the MAPK inhibitor therapy resistance and untreated associated attractors.</p>
<p>Now, we can take a look at the attractors that passed filtering criterion 2. We show the first 10 rows here, but you can view the entire set in <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/colorectal_cancer_validation/results/3-marker-nodes/successful_controlnode_perturbations.txt"><code>successful_controlnode_perturbations.txt</code></a></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r foldable"><code class="sourceCode r"><span id="cb20-1"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb20-1"></a>crit2_<span class="dv">3</span>&lt;-<span class="kw">read.delim</span>(<span class="st">&#39;crc/results/3-marker-nodes/successful_controlnode_perturbations.txt&#39;</span>,<span class="dt">sep=</span><span class="st">&quot; &quot;</span>,<span class="dt">as.is =</span> T)</span>
<span id="cb20-2"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb20-2"></a><span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&#39;number of perturbations that pass filtering criteria 2: &#39;</span>,<span class="kw">nrow</span>(crit2_<span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;number of perturbations that pass filtering criteria 2: 52703&quot;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r foldable"><code class="sourceCode r"><span id="cb22-1"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb22-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(crit2_<span class="dv">3</span>[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,])  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">column_spec</span>(<span class="dv">15</span>, <span class="dt">bold =</span> F, <span class="dt">border_left =</span> T) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">scroll_box</span>(<span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>, <span class="dt">box_css =</span> <span class="st">&quot;border: 0px;&quot;</span>) </span></code></pre></div>
<div style="border: 0px;overflow-x: scroll; width:100%; ">
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
AKT1
</th>
<th style="text-align:left;">
CCNA1
</th>
<th style="text-align:left;">
CTNNB1
</th>
<th style="text-align:left;">
E2F1
</th>
<th style="text-align:left;">
GRB2
</th>
<th style="text-align:left;">
MAPK1
</th>
<th style="text-align:left;">
MAPK14
</th>
<th style="text-align:left;">
MAPK8
</th>
<th style="text-align:left;">
MDM2
</th>
<th style="text-align:left;">
PDK1
</th>
<th style="text-align:left;">
SMAD7
</th>
<th style="text-align:left;">
SRC
</th>
<th style="text-align:left;">
TSC1
</th>
<th style="text-align:right;">
up
</th>
<th style="text-align:right;">
down
</th>
<th style="text-align:right;">
total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
pert_797158
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_265717
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_620011
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_738109
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_777475
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_790597
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_794971
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_796429
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_796915
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_797077
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
<p>We can look to see if there are any trends in the orientation of the perturbations on FVS control nodes across the perturbations that passed both filtering criteria.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r foldable"><code class="sourceCode r"><span id="cb23-1"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb23-1"></a><span class="kw">library</span>(data.table)</span>
<span id="cb23-2"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb23-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb23-3"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb23-3"></a>d3&lt;-crit2_<span class="dv">3</span>[,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>)] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">transpose</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.matrix</span>()</span>
<span id="cb23-4"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb23-4"></a><span class="kw">row.names</span>(d3)&lt;-<span class="kw">colnames</span>(crit2_<span class="dv">3</span>[<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>])</span>
<span id="cb23-5"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb23-5"></a><span class="kw">colnames</span>(d3)&lt;-<span class="kw">row.names</span>(crit2_<span class="dv">3</span>)</span>
<span id="cb23-6"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb23-6"></a>d3r&lt;-reshape2<span class="op">::</span><span class="kw">melt</span>(d3) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>Var2)</span>
<span id="cb23-7"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb23-7"></a></span>
<span id="cb23-8"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb23-8"></a><span class="co">#From Paul Tol: https://personal.sron.nl/~pault/</span></span>
<span id="cb23-9"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb23-9"></a>Tol_muted &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;#88CCEE&#39;</span>, <span class="st">&#39;#44AA99&#39;</span>, <span class="st">&#39;#117733&#39;</span>, <span class="st">&#39;#332288&#39;</span>, <span class="st">&#39;#DDCC77&#39;</span>, <span class="st">&#39;#999933&#39;</span>,<span class="st">&#39;#CC6677&#39;</span>, <span class="st">&#39;#882255&#39;</span>, <span class="st">&#39;#AA4499&#39;</span>, <span class="st">&#39;#DDDDDD&#39;</span>)</span>
<span id="cb23-10"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb23-10"></a></span>
<span id="cb23-11"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb23-11"></a><span class="kw">ggplot</span>(d3r, <span class="kw">aes</span>(<span class="dt">x=</span>value)) <span class="op">+</span></span>
<span id="cb23-12"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb23-12"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Var1,<span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>,<span class="dt">shrink=</span><span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb23-13"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb23-13"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> (..count..)<span class="op">/</span><span class="kw">ncol</span>(d3),<span class="dt">fill=</span>value))  <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels=</span>scales<span class="op">::</span>percent) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>Tol_muted)<span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;% of specified perturbation to an FVS control node across all </span><span class="ch">\n</span><span class="st"> combinations of perturbations that passed filtering criteria &quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;node perturbation&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-41"></span>
<img src="_main_files/figure-html/unnamed-chunk-41-1.png" alt="the precentage of specific perturbations on FVS control nodes in the perturbations that passed the filtering criteria" width="1152" />
<p class="caption">
Figure 7.3: the precentage of specific perturbations on FVS control nodes in the perturbations that passed the filtering criteria
</p>
</div>
<p>Here, we see that in the majority of perturbations, SRC is knocked-out.</p>
<p>The steady-state values of the internal-marker nodes for these perturbations can be found in <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/colorectal_cancer_validation/results/3-marker-nodes/pert_internal_markers.txt"><code>pert1_internal_markers.txt</code></a>.</p>
<p>The combination BRAFi+SRCi treatment was identified and experimentally validated by Park et al., to overcome adaptive resistance to MAPK inhibitor therapy in HT29 cells. This perturbation, pert_797158, passed both of our filtering criteria. We can plot the steady-state values of the internal-marker nodes for HT29_BRAFi, H29_BRAFi+EGFRi, and HT29_BRAFi+SRCi using a radar plot.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r foldable"><code class="sourceCode r"><span id="cb24-1"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-1"></a><span class="kw">library</span>(fmsb)</span>
<span id="cb24-2"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-2"></a>attr_pert&lt;-<span class="kw">read.delim</span>(<span class="st">&quot;crc/results/3-marker-nodes/pert_internal_markers.txt&quot;</span>,<span class="dt">sep=</span><span class="st">&quot; &quot;</span>,<span class="dt">row.names =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">where</span>(is.numeric), <span class="op">~</span><span class="st"> </span><span class="kw">round</span>(., <span class="dt">digits =</span> <span class="dv">3</span>)))</span>
<span id="cb24-3"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-3"></a>attr_pert &lt;-attr_pert[<span class="kw">c</span>(<span class="st">&#39;pert_797158&#39;</span>),]</span>
<span id="cb24-4"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-4"></a>exp&lt;-<span class="kw">read.delim</span>(<span class="st">&quot;crc/results/3-marker-nodes/exp_internalmarkers.txt&quot;</span>,<span class="dt">sep=</span><span class="st">&quot; &quot;</span>,<span class="dt">row.names =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">where</span>(is.numeric), <span class="op">~</span><span class="st"> </span><span class="kw">round</span>(., <span class="dt">digits =</span> <span class="dv">3</span>)))</span>
<span id="cb24-5"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-5"></a>exp&lt;-exp[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),]</span>
<span id="cb24-6"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-6"></a></span>
<span id="cb24-7"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-7"></a>d1&lt;-<span class="kw">rbind</span>(exp,attr_pert) </span>
<span id="cb24-8"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-8"></a></span>
<span id="cb24-9"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-9"></a>maxcol&lt;-<span class="kw">apply</span>(exp, <span class="dv">2</span>, max)</span>
<span id="cb24-10"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-10"></a>mincol&lt;-<span class="kw">apply</span>(exp, <span class="dv">2</span>, min)</span>
<span id="cb24-11"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-11"></a>d2&lt;-<span class="kw">rbind</span>(maxcol,mincol, exp)</span>
<span id="cb24-12"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-12"></a><span class="kw">rownames</span>(d2)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Max&quot;</span>, <span class="st">&quot;Min&quot;</span>)</span>
<span id="cb24-13"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-13"></a><span class="kw">create_beautiful_radarchart</span>(d2,<span class="dt">color =</span> <span class="kw">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>,<span class="st">&quot;#FC4E07&quot;</span>),<span class="dt">caxislabels =</span> <span class="kw">seq</span>(<span class="kw">min</span>(d2),<span class="kw">max</span>(d2),.<span class="dv">4</span>),<span class="dt">title =</span><span class="st">&quot;resistant and sensitive attractors&quot;</span>);<span class="kw">legend</span>(<span class="dt">x=</span><span class="fl">0.4</span>, <span class="dt">y=</span><span class="fl">1.4</span>, <span class="dt">legend =</span><span class="kw">c</span>(<span class="kw">row.names</span>(d2)[<span class="dv">3</span><span class="op">:</span><span class="kw">nrow</span>(d2)]) , <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span> , <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>,<span class="st">&quot;#FC4E07&quot;</span>) , <span class="dt">text.col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">pt.cex=</span><span class="dv">2</span>)</span>
<span id="cb24-14"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-14"></a></span>
<span id="cb24-15"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-15"></a><span class="co"># library(NMF)</span></span>
<span id="cb24-16"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-16"></a><span class="co"># annot&lt;-c(&quot;sensitive&quot;,&quot;resistant&quot;,&quot;perturbation&quot;)</span></span>
<span id="cb24-17"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-17"></a><span class="co"># aheatmap(t(d1),scale=&quot;none&quot;,Rowv = NA,color = colorRampPalette(c(&quot;navy&quot;, &quot;white&quot;, &quot;firebrick3&quot;))(80), annCol=annot,cellwidth = 30)</span></span>
<span id="cb24-18"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-18"></a></span>
<span id="cb24-19"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-19"></a><span class="kw">rownames</span>(d1)[<span class="dv">3</span>]&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;HT29_BRAFi+SRCi&quot;</span>)</span>
<span id="cb24-20"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-20"></a>maxcol&lt;-<span class="kw">apply</span>(d1, <span class="dv">2</span>, max)</span>
<span id="cb24-21"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-21"></a>mincol&lt;-<span class="kw">apply</span>(d1, <span class="dv">2</span>, min)</span>
<span id="cb24-22"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-22"></a></span>
<span id="cb24-23"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-23"></a>d2&lt;-<span class="kw">rbind</span>(maxcol,mincol, d1)</span>
<span id="cb24-24"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-24"></a><span class="kw">rownames</span>(d2)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Max&quot;</span>, <span class="st">&quot;Min&quot;</span>)</span>
<span id="cb24-25"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-25"></a></span>
<span id="cb24-26"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-26"></a></span>
<span id="cb24-27"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-27"></a></span>
<span id="cb24-28"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-28"></a></span>
<span id="cb24-29"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-29"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="fl">0.1</span>, <span class="dv">4</span>, <span class="fl">0.1</span>))</span>
<span id="cb24-30"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-30"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">5</span><span class="op">:</span><span class="kw">nrow</span>(d2)) {</span>
<span id="cb24-31"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-31"></a>  <span class="kw">create_beautiful_radarchart</span>(d2[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, i), ],<span class="dt">color =</span> <span class="kw">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>,<span class="st">&quot;#FC4E07&quot;</span>),<span class="dt">caxislabels =</span> <span class="kw">seq</span>(<span class="kw">round</span>(<span class="kw">min</span>(d2[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, i),]),<span class="dv">1</span>),<span class="kw">round</span>(<span class="kw">max</span>(d2[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, i),]),<span class="dv">1</span>),.<span class="dv">2</span>),<span class="dt">title =</span><span class="kw">row.names</span>(d2)[i]);<span class="kw">legend</span>(<span class="dt">x=</span><span class="fl">0.4</span>, <span class="dt">y=</span><span class="fl">1.4</span>, <span class="dt">legend =</span><span class="kw">c</span>(<span class="kw">row.names</span>(d2)[<span class="dv">3</span><span class="op">:</span><span class="kw">nrow</span>(d2)]) , <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span> , <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>,<span class="st">&quot;#FC4E07&quot;</span>) , <span class="dt">text.col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">pt.cex=</span><span class="dv">2</span>)</span>
<span id="cb24-32"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb24-32"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:crc-charts"></span>
<img src="_main_files/figure-html/crc-charts-1.png" alt="radar charts of the steady-state values of 3 internal-marker nodes for HT29_BRAFi+SRCi" width="50%" /><img src="_main_files/figure-html/crc-charts-2.png" alt="radar charts of the steady-state values of 3 internal-marker nodes for HT29_BRAFi+SRCi" width="50%" />
<p class="caption">
Figure 7.4: radar charts of the steady-state values of 3 internal-marker nodes for HT29_BRAFi+SRCi
</p>
</div>
<p>We see here that the steady state value of CASP3 in the attractor produced from the HT29_BRAFi+SRCi perturbation is within the range of attractor produced from the HT29_BRAFi+EGFRi perturbation.</p>
</div>
<div id="results-using-apoptosis-proliferation-and-mapk-signaling-internal-marker-nodes" class="section level3">
<h3><span class="header-section-number">7.3.3</span> Results using apoptosis, proliferation, and MAPK signaling internal-marker nodes</h3>
<p>We filtered the 52,703 perturbations using an additional 17 internal-marker nodes for the phenotypes of apoptosis, proliferation, and mapk signaling.</p>
<p>The individual results for all three sets can be found in their respective folders on github:
<a href="https://github.com/VeraLiconaResearchGroup/Netisce/tree/main/colorectal_cancer_validation/results/apoptosis-marker-nodes"><code>apoptosis-marker-nodes</code></a>
<a href="https://github.com/VeraLiconaResearchGroup/Netisce/tree/main/colorectal_cancer_validation/results/mapk-marker-nodes"><code>mapk-marker-nodes</code></a>
<a href="https://github.com/VeraLiconaResearchGroup/Netisce/tree/main/colorectal_cancer_validation/results/proliferation-marker-nodes"><code>proliferation-marker-nodes</code></a></p>
<p>We are interested in perturbations on FVS control nodes that pass the filtering criterion for each of the three phenotypes (i.e., the 90% threshold for steady-state values is met separately for each of the sets of apoptosis, MAPK signaling, and proliferation nodes). We can plot the node perturbation trends for these perturbations.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r foldable"><code class="sourceCode r"><span id="cb25-1"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb25-1"></a>allthree&lt;-crit2_<span class="dv">3</span>[<span class="kw">c</span>(<span class="kw">Reduce</span>(intersect, <span class="kw">list</span>(<span class="kw">row.names</span>(crit2_<span class="dv">3</span>),<span class="kw">row.names</span>(crit2_apop),<span class="kw">row.names</span>(crit2_prolif),<span class="kw">row.names</span>(crit2_mapk)))),]</span>
<span id="cb25-2"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb25-2"></a><span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&#39;number of perturbations that pass filtering criteria 2: &#39;</span>,<span class="kw">nrow</span>(allthree)))</span></code></pre></div>
<pre><code>## [1] &quot;number of perturbations that pass filtering criteria 2: 1266&quot;</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r foldable"><code class="sourceCode r"><span id="cb27-1"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb27-1"></a>d4&lt;-allthree[,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>)] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">transpose</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.matrix</span>()</span>
<span id="cb27-2"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb27-2"></a><span class="kw">row.names</span>(d4)&lt;-<span class="kw">colnames</span>(allthree[<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>])</span>
<span id="cb27-3"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb27-3"></a><span class="kw">colnames</span>(d4)&lt;-<span class="kw">row.names</span>(allthree)</span>
<span id="cb27-4"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb27-4"></a>d4r&lt;-reshape2<span class="op">::</span><span class="kw">melt</span>(d4) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>Var2)</span>
<span id="cb27-5"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb27-5"></a></span>
<span id="cb27-6"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb27-6"></a></span>
<span id="cb27-7"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb27-7"></a></span>
<span id="cb27-8"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb27-8"></a><span class="kw">ggplot</span>(d4r, <span class="kw">aes</span>(<span class="dt">x=</span>value)) <span class="op">+</span></span>
<span id="cb27-9"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb27-9"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Var1,<span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>,<span class="dt">shrink=</span><span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb27-10"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb27-10"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> (..count..)<span class="op">/</span><span class="kw">ncol</span>(d4),<span class="dt">fill=</span>value))  <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels=</span>scales<span class="op">::</span>percent)<span class="op">+</span></span>
<span id="cb27-11"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb27-11"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.spacing.x =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;mm&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>Tol_muted) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;% of specified perturbation to an FVS control node across all </span><span class="ch">\n</span><span class="st"> combinations of perturbations that passed filtering criteria &quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;node perturbation&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:all-three"></span>
<img src="_main_files/figure-html/all-three-1.png" alt="the precentage of specific perturbations on FVS control nodes in the perturbations that passed the filtering criteria" width="672" />
<p class="caption">
Figure 7.5: the precentage of specific perturbations on FVS control nodes in the perturbations that passed the filtering criteria
</p>
</div>
<p>For perturbations that pass the 2nd filtering criterion using internal-marker nodes for apoptosis, MAPK sigaling and proliferation, we see that in 100% of the perturbations SRC is downregulated. In the majority of of perturbations, TSC1 is upregulated, and GRB2 is downregulated.</p>
<p>The two smallest sets of perturbations that passed the filtering criteria were BRAFi+SRCi+TSC1overexpression (pert_797159) and BRAFi+SRCi+GRB2i (pert_790597). We can make radar charts for each phenotype’s internal marker nodes to show that the steady-state values for the internal marker-nodes produced from these perturbations are within the gene expression range of the MAPK inhibitor therapy sensitivty assocaited attractor (HT29_BRAFi+EGFRi).</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r foldable"><code class="sourceCode r"><span id="cb28-1"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-1"></a>attr_pert&lt;-<span class="kw">read.delim</span>(<span class="st">&quot;crc/results/apoptosis-marker-nodes/pert_internal_markers.txt&quot;</span>,<span class="dt">sep=</span><span class="st">&quot; &quot;</span>,<span class="dt">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb28-2"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-2"></a>attr_pert &lt;-attr_pert[<span class="kw">c</span>(<span class="st">&#39;pert_797159&#39;</span>,<span class="st">&#39;pert_790597&#39;</span>),]</span>
<span id="cb28-3"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-3"></a>exp&lt;-<span class="kw">read.delim</span>(<span class="st">&quot;crc/results/apoptosis-marker-nodes/exp_internalmarkers.txt&quot;</span>,<span class="dt">sep=</span><span class="st">&quot; &quot;</span>,<span class="dt">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb28-4"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-4"></a>exp&lt;-exp[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),]</span>
<span id="cb28-5"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-5"></a></span>
<span id="cb28-6"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-6"></a>d1&lt;-<span class="kw">rbind</span>(exp,attr_pert)</span>
<span id="cb28-7"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-7"></a></span>
<span id="cb28-8"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-8"></a><span class="kw">rownames</span>(d1)[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>]&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;HT29_BRAFi+SRCi+TSCovr&quot;</span>,<span class="st">&quot;HT29_BRAFi+SRCi+GRB2i&quot;</span>)</span>
<span id="cb28-9"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-9"></a>maxcol&lt;-<span class="kw">apply</span>(d1, <span class="dv">2</span>, max)</span>
<span id="cb28-10"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-10"></a>mincol&lt;-<span class="kw">apply</span>(d1, <span class="dv">2</span>, min)</span>
<span id="cb28-11"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-11"></a></span>
<span id="cb28-12"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-12"></a>d2&lt;-<span class="kw">rbind</span>(maxcol,mincol, d1)</span>
<span id="cb28-13"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-13"></a><span class="kw">rownames</span>(d2)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Max&quot;</span>, <span class="st">&quot;Min&quot;</span>)</span>
<span id="cb28-14"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-14"></a></span>
<span id="cb28-15"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-15"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="fl">0.1</span>, <span class="dv">4</span>, <span class="fl">0.1</span>))</span>
<span id="cb28-16"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-16"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">5</span><span class="op">:</span><span class="kw">nrow</span>(d2)) {</span>
<span id="cb28-17"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-17"></a>  <span class="kw">create_beautiful_radarchart</span>(d2[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, i), ],<span class="dt">color =</span> <span class="kw">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>,<span class="st">&quot;#FC4E07&quot;</span>),<span class="dt">caxislabels =</span> <span class="kw">seq</span>(<span class="kw">round</span>(<span class="kw">min</span>(d2[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, i),]),<span class="dv">1</span>),<span class="kw">round</span>(<span class="kw">max</span>(d2[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, i),]),<span class="dv">1</span>),.<span class="dv">2</span>),<span class="dt">title =</span><span class="kw">row.names</span>(d2)[i]);<span class="kw">legend</span>(<span class="dt">x=</span><span class="fl">0.4</span>, <span class="dt">y=</span><span class="fl">1.4</span>, <span class="dt">legend =</span><span class="kw">c</span>(<span class="kw">row.names</span>(d2)[<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,i)]) , <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span> , <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>,<span class="st">&quot;#FC4E07&quot;</span>) , <span class="dt">text.col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">pt.cex=</span><span class="dv">2</span>)</span>
<span id="cb28-18"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb28-18"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:crc-chartsapop"></span>
<img src="_main_files/figure-html/crc-chartsapop-1.png" alt="radar charts of the steady-state values of apoptosis internal-marker nodes for HT29_BRAFi+SRCi_TSCovr and HT29_BRAFi+SRCi_GRB2i" width="50%" /><img src="_main_files/figure-html/crc-chartsapop-2.png" alt="radar charts of the steady-state values of apoptosis internal-marker nodes for HT29_BRAFi+SRCi_TSCovr and HT29_BRAFi+SRCi_GRB2i" width="50%" />
<p class="caption">
Figure 7.6: radar charts of the steady-state values of apoptosis internal-marker nodes for HT29_BRAFi+SRCi_TSCovr and HT29_BRAFi+SRCi_GRB2i
</p>
</div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r foldable"><code class="sourceCode r"><span id="cb29-1"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-1"></a>attr_pert&lt;-<span class="kw">read.delim</span>(<span class="st">&quot;crc/results/mapk-marker-nodes/pert_internal_markers.txt&quot;</span>,<span class="dt">sep=</span><span class="st">&quot; &quot;</span>,<span class="dt">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb29-2"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-2"></a>attr_pert &lt;-attr_pert[<span class="kw">c</span>(<span class="st">&#39;pert_797159&#39;</span>,<span class="st">&#39;pert_790597&#39;</span>),]</span>
<span id="cb29-3"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-3"></a>exp&lt;-<span class="kw">read.delim</span>(<span class="st">&quot;crc/results/mapk-marker-nodes/exp_internalmarkers.txt&quot;</span>,<span class="dt">sep=</span><span class="st">&quot; &quot;</span>,<span class="dt">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb29-4"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-4"></a>exp&lt;-exp[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),]</span>
<span id="cb29-5"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-5"></a></span>
<span id="cb29-6"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-6"></a>d1&lt;-<span class="kw">rbind</span>(exp,attr_pert)</span>
<span id="cb29-7"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-7"></a></span>
<span id="cb29-8"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-8"></a><span class="kw">rownames</span>(d1)[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>]&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;HT29_BRAFi+SRCi+TSCovr&quot;</span>,<span class="st">&quot;HT29_BRAFi+SRCi+GRB2i&quot;</span>)</span>
<span id="cb29-9"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-9"></a>maxcol&lt;-<span class="kw">apply</span>(d1, <span class="dv">2</span>, max)</span>
<span id="cb29-10"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-10"></a>mincol&lt;-<span class="kw">apply</span>(d1, <span class="dv">2</span>, min)</span>
<span id="cb29-11"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-11"></a></span>
<span id="cb29-12"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-12"></a>d2&lt;-<span class="kw">rbind</span>(maxcol,mincol, d1)</span>
<span id="cb29-13"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-13"></a><span class="kw">rownames</span>(d2)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Max&quot;</span>, <span class="st">&quot;Min&quot;</span>)</span>
<span id="cb29-14"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-14"></a></span>
<span id="cb29-15"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-15"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="fl">0.1</span>, <span class="dv">4</span>, <span class="fl">0.1</span>))</span>
<span id="cb29-16"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-16"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">5</span><span class="op">:</span><span class="kw">nrow</span>(d2)) {</span>
<span id="cb29-17"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-17"></a>  <span class="kw">create_beautiful_radarchart</span>(d2[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, i), ],<span class="dt">color =</span> <span class="kw">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>,<span class="st">&quot;#FC4E07&quot;</span>),<span class="dt">caxislabels =</span> <span class="kw">seq</span>(<span class="kw">round</span>(<span class="kw">min</span>(d2[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, i),]),<span class="dv">1</span>),<span class="kw">round</span>(<span class="kw">max</span>(d2[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, i),]),<span class="dv">1</span>),.<span class="dv">2</span>),<span class="dt">title =</span><span class="kw">row.names</span>(d2)[i]);<span class="co">#legend(x=0.4, y=1.4, legend =c(row.names(d2)[c(3,4,i)]) , bty = &quot;n&quot;, pch=20 , col=c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;,&quot;#FC4E07&quot;) , text.col = &quot;black&quot;, cex=1, pt.cex=2)</span></span>
<span id="cb29-18"><a href="adaptive-resistance-in-colorectal-cancer-example.html#cb29-18"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:crc-chartsmapk"></span>
<img src="_main_files/figure-html/crc-chartsmapk-1.png" alt="radar charts of the steady-state values of MAPK signaling internal-marker nodes for HT29_BRAFi+SRCi_TSCovr and HT29_BRAFi+SRCi_GRB2i" width="50%" /><img src="_main_files/figure-html/crc-chartsmapk-2.png" alt="radar charts of the steady-state values of MAPK signaling internal-marker nodes for HT29_BRAFi+SRCi_TSCovr and HT29_BRAFi+SRCi_GRB2i" width="50%" />
<p class="caption">
Figure 7.7: radar charts of the steady-state values of MAPK signaling internal-marker nodes for HT29_BRAFi+SRCi_TSCovr and HT29_BRAFi+SRCi_GRB2i
</p>
</div>
<!-- # ```{r radar-plots-for-paper, out.width='50%',echo = TRUE,fig.show='hold',fig.cap = "radar charts of the steady-state values of 7 internal-marker nodes perturbation"} -->
<!-- #  -->
<!-- #  -->
<!-- # attr_pert<-read.delim("ipsc/results/pert1_internal_markers.txt",sep=" ",row.names = 1) -->
<!-- # attr_pert <-attr_pert[c('pert_445','pert_365'),c('Oct4',"Sox2","Nanog","EpiTFs")] -->
<!-- # exp<-read.delim("ipsc/results/original-exp_internalmarkers.txt",sep=" ",row.names = 1) -->
<!-- # EpiSC_avg<-colMeans(exp[4:6,]) -->
<!-- # ESC_avg<-colMeans(exp[1:3,]) -->
<!-- #  -->
<!-- # d1<-rbind(EpiSC_avg,ESC_avg,attr_pert) -->
<!-- # rownames(d1)[1:4]<- c("EpiSC", "ESC","Nanog overexpression","Klf4 overexpression") -->
<!-- # maxcol<-apply(d1, 2, max) -->
<!-- # mincol<-apply(d1, 2, min) -->
<!-- #  -->
<!-- # d2<-rbind(maxcol,mincol, d1) -->
<!-- # rownames(d2)[1:2]<- c("Max", "Min") -->
<!-- #  -->
<!-- # par(mar = c(4, 0.1, 4, 0.1)) -->
<!-- #  -->
<!-- #  -->
<!-- # for (i in 5:nrow(d2)) { -->
<!-- #   create_beautiful_radarchart(d2[c(1:4, i), ],color = c("#00AFBB", "#E7B800","#FC4E07"),caxislabels = seq(round(min(d2[c(1:4, i),]),1),round(max(d2[c(1:4, i),]),1),.2),title =row.names(d2)[i]);legend(x=0.4, y=1.4, legend =c("average EpiSC","average ESC",row.names(d2)[i]) , bty = "n", pch=20 , col=c("#00AFBB", "#E7B800","#FC4E07") , text.col = "black", cex=1, pt.cex=2) -->
<!-- # } -->
<!-- # ``` -->
<!-- #  -->
<!-- #  -->
<!-- # ```{r radar-plots-for-paper2, out.width='33%',echo = TRUE,fig.show='hold',fig.cap = "radar charts of the steady-state values of 7 internal-marker nodes perturbation"} -->
<!-- #  -->
<!-- #  -->
<!-- # attr_pert<-read.delim("ipsc/results/pert1_internal_markers.txt",sep=" ",row.names = 1) -->
<!-- # attr_pert <-attr_pert[c('pert_445','pert_365','pert_446'),] -->
<!-- # exp<-read.delim("ipsc/results/original-exp_internalmarkers.txt",sep=" ",row.names = 1) -->
<!-- # EpiSC_avg<-colMeans(exp[4:6,]) -->
<!-- # ESC_avg<-colMeans(exp[1:3,]) -->
<!-- #  -->
<!-- # d1<-rbind(EpiSC_avg,ESC_avg,attr_pert) -->
<!-- # rownames(d1)[1:5]<- c("EpiSC", "ESC","Nanog overexpression","Klf4 overexpression","Nanog+Klf4 overexpression") -->
<!-- # maxcol<-apply(d1, 2, max) -->
<!-- # mincol<-apply(d1, 2, min) -->
<!-- #  -->
<!-- # d2<-rbind(maxcol,mincol, d1) -->
<!-- # rownames(d2)[1:2]<- c("Max", "Min") -->
<!-- #  -->
<!-- # par(mar = c(4, 0.1, 4, 0.1)) -->
<!-- #  -->
<!-- #  -->
<!-- # for (i in 5:nrow(d2)) { -->
<!-- #   create_beautiful_radarchart(d2[c(1:4, i), ],color = c("#00AFBB", "#E7B800","#FC4E07"),caxislabels = seq(round(min(d2[c(1:4, i),]),1),round(max(d2[c(1:4, i),]),1),.2),title =row.names(d2)[i]);legend(x=0.4, y=1.4, legend =c("average EpiSC","average ESC",row.names(d2)[i]) , bty = "n", pch=20 , col=c("#00AFBB", "#E7B800","#FC4E07") , text.col = "black", cex=.8, pt.cex=1.8) -->
<!-- # } -->
<!-- # ``` -->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pluripotent-stem-cell-example.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="evaluating-the-robustness-to-noise-of-netisce.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/VeraLiconaResearchGroup/Netisce/tree/gh-pages/06-crc.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
