<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Pluripotent Stem Cell Example | NETISCE Manual and Tutorials</title>
  <meta name="description" content="Welcome to the NETISCE manual and tutorials. NETISCE is a network-based approach for cellular reprogramming. This manual contains directions for intial setup, as well as tutorials for reproducing NETISCE cell reprogramming results in developmental, stem cell, and cancer biology." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Pluripotent Stem Cell Example | NETISCE Manual and Tutorials" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://veraliconaresearchgroup.github.io/Netisce/" />
  <meta property="og:image" content="https://veraliconaresearchgroup.github.io/Netisce/images/netisce-logo.png" />
  <meta property="og:description" content="Welcome to the NETISCE manual and tutorials. NETISCE is a network-based approach for cellular reprogramming. This manual contains directions for intial setup, as well as tutorials for reproducing NETISCE cell reprogramming results in developmental, stem cell, and cancer biology." />
  <meta name="github-repo" content="https://github.com/veraliconaresearchgroup/netisce" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Pluripotent Stem Cell Example | NETISCE Manual and Tutorials" />
  
  <meta name="twitter:description" content="Welcome to the NETISCE manual and tutorials. NETISCE is a network-based approach for cellular reprogramming. This manual contains directions for intial setup, as well as tutorials for reproducing NETISCE cell reprogramming results in developmental, stem cell, and cancer biology." />
  <meta name="twitter:image" content="https://veraliconaresearchgroup.github.io/Netisce/images/netisce-logo.png" />

<meta name="author" content="Lauren Marazzi" />


<meta name="date" content="2022-05-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cell-fate-specification-in-ascidian-embryo.html"/>
<link rel="next" href="adaptive-resistance-in-colorectal-cancer-example.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">NETISCE manual and tutorials</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="chapter" data-level="2" data-path="installation-and-usage.html"><a href="installation-and-usage.html"><i class="fa fa-check"></i><b>2</b> Installation and Usage</a><ul>
<li class="chapter" data-level="2.1" data-path="installation-and-usage.html"><a href="installation-and-usage.html#download-netisce"><i class="fa fa-check"></i><b>2.1</b> Download NETISCE</a></li>
<li class="chapter" data-level="2.2" data-path="installation-and-usage.html"><a href="installation-and-usage.html#install-nextflow"><i class="fa fa-check"></i><b>2.2</b> Install Nextflow</a></li>
<li class="chapter" data-level="2.3" data-path="installation-and-usage.html"><a href="installation-and-usage.html#prerequisuites"><i class="fa fa-check"></i><b>2.3</b> Prerequisuites</a></li>
<li class="chapter" data-level="2.4" data-path="installation-and-usage.html"><a href="installation-and-usage.html#docker-image"><i class="fa fa-check"></i><b>2.4</b> Docker Image</a></li>
<li class="chapter" data-level="2.5" data-path="installation-and-usage.html"><a href="installation-and-usage.html#params"><i class="fa fa-check"></i><b>2.5</b> Parameters and Configuration</a><ul>
<li class="chapter" data-level="2.5.1" data-path="installation-and-usage.html"><a href="installation-and-usage.html#netisce_mutations.nf"><i class="fa fa-check"></i><b>2.5.1</b> NETISCE_mutations.nf</a></li>
<li class="chapter" data-level="2.5.2" data-path="installation-and-usage.html"><a href="installation-and-usage.html#nextflow.config"><i class="fa fa-check"></i><b>2.5.2</b> nextflow.config</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="installation-and-usage.html"><a href="installation-and-usage.html#running-netisce"><i class="fa fa-check"></i><b>2.6</b> Running NETISCE</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="netsice-output.html"><a href="netsice-output.html"><i class="fa fa-check"></i><b>3</b> NETSICE output</a></li>
<li class="chapter" data-level="4" data-path="toy.html"><a href="toy.html"><i class="fa fa-check"></i><b>4</b> Toy Network Examples</a><ul>
<li class="chapter" data-level="4.1" data-path="toy.html"><a href="toy.html#overview"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="toy.html"><a href="toy.html#data"><i class="fa fa-check"></i><b>4.2</b> Data</a></li>
<li class="chapter" data-level="4.3" data-path="toy.html"><a href="toy.html#netisce-run-configuration"><i class="fa fa-check"></i><b>4.3</b> NETISCE run configuration</a></li>
<li class="chapter" data-level="4.4" data-path="toy.html"><a href="toy.html#run-netisce"><i class="fa fa-check"></i><b>4.4</b> Run NETISCE</a></li>
<li class="chapter" data-level="4.5" data-path="toy.html"><a href="toy.html#netsice-results"><i class="fa fa-check"></i><b>4.5</b> NETSICE Results</a></li>
<li class="chapter" data-level="4.6" data-path="toy.html"><a href="toy.html#toy-example-with-mutations"><i class="fa fa-check"></i><b>4.6</b> Toy Example with mutations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cell-fate-specification-in-ascidian-embryo.html"><a href="cell-fate-specification-in-ascidian-embryo.html"><i class="fa fa-check"></i><b>5</b> Cell Fate Specification in Ascidian Embryo</a><ul>
<li class="chapter" data-level="5.1" data-path="cell-fate-specification-in-ascidian-embryo.html"><a href="cell-fate-specification-in-ascidian-embryo.html#input-data"><i class="fa fa-check"></i><b>5.1</b> Input Data</a></li>
<li class="chapter" data-level="5.2" data-path="cell-fate-specification-in-ascidian-embryo.html"><a href="cell-fate-specification-in-ascidian-embryo.html#run-the-simulation"><i class="fa fa-check"></i><b>5.2</b> Run the simulation</a></li>
<li class="chapter" data-level="5.3" data-path="cell-fate-specification-in-ascidian-embryo.html"><a href="cell-fate-specification-in-ascidian-embryo.html#results"><i class="fa fa-check"></i><b>5.3</b> Results</a></li>
<li class="chapter" data-level="5.4" data-path="cell-fate-specification-in-ascidian-embryo.html"><a href="cell-fate-specification-in-ascidian-embryo.html#visualizing-results"><i class="fa fa-check"></i><b>5.4</b> Visualizing Results</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="pluripotent-stem-cell-example.html"><a href="pluripotent-stem-cell-example.html"><i class="fa fa-check"></i><b>6</b> Pluripotent Stem Cell Example</a><ul>
<li class="chapter" data-level="6.1" data-path="pluripotent-stem-cell-example.html"><a href="pluripotent-stem-cell-example.html#input-data-1"><i class="fa fa-check"></i><b>6.1</b> Input Data</a></li>
<li class="chapter" data-level="6.2" data-path="pluripotent-stem-cell-example.html"><a href="pluripotent-stem-cell-example.html#run-the-simulation-1"><i class="fa fa-check"></i><b>6.2</b> Run the simulation</a></li>
<li class="chapter" data-level="6.3" data-path="pluripotent-stem-cell-example.html"><a href="pluripotent-stem-cell-example.html#results-1"><i class="fa fa-check"></i><b>6.3</b> Results</a><ul>
<li class="chapter" data-level="6.3.1" data-path="pluripotent-stem-cell-example.html"><a href="pluripotent-stem-cell-example.html#general-results"><i class="fa fa-check"></i><b>6.3.1</b> General Results</a></li>
<li class="chapter" data-level="6.3.2" data-path="pluripotent-stem-cell-example.html"><a href="pluripotent-stem-cell-example.html#results-using-4-internal-marker-nodes"><i class="fa fa-check"></i><b>6.3.2</b> Results using 4 internal-marker nodes</a></li>
<li class="chapter" data-level="6.3.3" data-path="pluripotent-stem-cell-example.html"><a href="pluripotent-stem-cell-example.html#results-using-7-internal-marker-nodes"><i class="fa fa-check"></i><b>6.3.3</b> Results using 7 internal-marker nodes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="adaptive-resistance-in-colorectal-cancer-example.html"><a href="adaptive-resistance-in-colorectal-cancer-example.html"><i class="fa fa-check"></i><b>7</b> Adaptive Resistance in Colorectal Cancer Example</a><ul>
<li class="chapter" data-level="7.1" data-path="adaptive-resistance-in-colorectal-cancer-example.html"><a href="adaptive-resistance-in-colorectal-cancer-example.html#input-data-2"><i class="fa fa-check"></i><b>7.1</b> Input Data</a></li>
<li class="chapter" data-level="7.2" data-path="adaptive-resistance-in-colorectal-cancer-example.html"><a href="adaptive-resistance-in-colorectal-cancer-example.html#run-the-simulation-2"><i class="fa fa-check"></i><b>7.2</b> Run the simulation</a></li>
<li class="chapter" data-level="7.3" data-path="adaptive-resistance-in-colorectal-cancer-example.html"><a href="adaptive-resistance-in-colorectal-cancer-example.html#results-2"><i class="fa fa-check"></i><b>7.3</b> Results</a><ul>
<li class="chapter" data-level="7.3.1" data-path="adaptive-resistance-in-colorectal-cancer-example.html"><a href="adaptive-resistance-in-colorectal-cancer-example.html#general-results-1"><i class="fa fa-check"></i><b>7.3.1</b> General Results</a></li>
<li class="chapter" data-level="7.3.2" data-path="adaptive-resistance-in-colorectal-cancer-example.html"><a href="adaptive-resistance-in-colorectal-cancer-example.html#results-using-3-internal-marker-nodes"><i class="fa fa-check"></i><b>7.3.2</b> Results using 3 internal-marker nodes</a></li>
<li class="chapter" data-level="7.3.3" data-path="adaptive-resistance-in-colorectal-cancer-example.html"><a href="adaptive-resistance-in-colorectal-cancer-example.html#results-using-apoptosis-proliferation-and-mapk-signaling-internal-marker-nodes"><i class="fa fa-check"></i><b>7.3.3</b> Results using apoptosis, proliferation, and MAPK signaling internal-marker nodes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="evaluating-the-robustness-to-noise-of-netisce.html"><a href="evaluating-the-robustness-to-noise-of-netisce.html"><i class="fa fa-check"></i><b>8</b> Evaluating the Robustness to Noise of NETISCE</a><ul>
<li class="chapter" data-level="8.1" data-path="evaluating-the-robustness-to-noise-of-netisce.html"><a href="evaluating-the-robustness-to-noise-of-netisce.html#copasi-simualtions-of-mathematical-models"><i class="fa fa-check"></i><b>8.1</b> COPASI simualtions of mathematical models</a><ul>
<li class="chapter" data-level="8.1.1" data-path="evaluating-the-robustness-to-noise-of-netisce.html"><a href="evaluating-the-robustness-to-noise-of-netisce.html#von-dassows-drosophila-segment-polarity-gene-model"><i class="fa fa-check"></i><b>8.1.1</b> von Dassow’s Drosophila Segment Polarity Gene model</a></li>
<li class="chapter" data-level="8.1.2" data-path="evaluating-the-robustness-to-noise-of-netisce.html"><a href="evaluating-the-robustness-to-noise-of-netisce.html#zhou-cell-fate-specification-model"><i class="fa fa-check"></i><b>8.1.2</b> Zhou Cell Fate Specification model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="evaluating-the-robustness-to-noise-of-netisce.html"><a href="evaluating-the-robustness-to-noise-of-netisce.html#noisy-initial-states-files"><i class="fa fa-check"></i><b>8.2</b> Noisy initial states files</a></li>
<li class="chapter" data-level="8.3" data-path="evaluating-the-robustness-to-noise-of-netisce.html"><a href="evaluating-the-robustness-to-noise-of-netisce.html#running-the-netisce-simulations"><i class="fa fa-check"></i><b>8.3</b> Running the NETISCE simulations</a><ul>
<li class="chapter" data-level="8.3.1" data-path="evaluating-the-robustness-to-noise-of-netisce.html"><a href="evaluating-the-robustness-to-noise-of-netisce.html#drosophila-noise-studies-at-40-noise-in-initial-states"><i class="fa fa-check"></i><b>8.3.1</b> Drosophila noise studies at 40% noise in initial states</a></li>
<li class="chapter" data-level="8.3.2" data-path="evaluating-the-robustness-to-noise-of-netisce.html"><a href="evaluating-the-robustness-to-noise-of-netisce.html#pancreas-cell-fate-specification-at-10-noise-in-initial-states"><i class="fa fa-check"></i><b>8.3.2</b> Pancreas cell fate specification at 10% noise in initial states</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="netisce-in-galaxy-project.html"><a href="netisce-in-galaxy-project.html"><i class="fa fa-check"></i><b>9</b> NETISCE in Galaxy Project</a><ul>
<li class="chapter" data-level="9.1" data-path="netisce-in-galaxy-project.html"><a href="netisce-in-galaxy-project.html#installing-galaxy"><i class="fa fa-check"></i><b>9.1</b> Installing Galaxy</a></li>
<li class="chapter" data-level="9.2" data-path="netisce-in-galaxy-project.html"><a href="netisce-in-galaxy-project.html#installing-the-netisce-tool-from-galaxy-tool-shed."><i class="fa fa-check"></i><b>9.2</b> Installing the NETISCE tool from Galaxy Tool Shed.</a></li>
<li class="chapter" data-level="9.3" data-path="netisce-in-galaxy-project.html"><a href="netisce-in-galaxy-project.html#downloading-the-netisce-workflow."><i class="fa fa-check"></i><b>9.3</b> Downloading the NETISCE workflow.</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NETISCE Manual and Tutorials</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pluripotent-stem-cell-example" class="section level1">
<h1><span class="header-section-number">6</span> Pluripotent Stem Cell Example</h1>
<p>This section contains instructions to reproduce the results of simulating perturbations on FVS control nodes in a pluripotent stem cell signaling. The goal of these simulations is to identify targets that can reprogram cells from the Epiblast stem cell (EpiSC) fate towards the Embryonic Stem Cell (ESC) fate. You can read the original report here: link</p>
<p>The original study of reversion of primed pluripotency in mouse epiblast stem cells was performed by Yachie-Kinoshita et al. in “<a href="https://www.embopress.org/doi/full/10.15252/msb.20177952">Modeling signaling-dependent pluripotency with Boolean logic to predict cell fate transitions (Molecular Systems Biology (2018)14:e7952)</a>”. The network and internal-marker nodes were extracted from the publication and its supplementary material. The normalized expression data used for initial activities in NETISCE can be found at <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE62155">GSE62155</a>.</p>
<p>The input data, nextflow pipeline, and results of this simulation can be found in the <a href="https://github.com/VeraLiconaResearchGroup/Netisce/tree/main/ipsc_validation">ipsc folder</a> in the NETISCE github repository</p>
<div id="input-data-1" class="section level2">
<h2><span class="header-section-number">6.1</span> Input Data</h2>
<p><a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/ipsc_validation/input_data/network.sif"><code>network.sif</code></a> contains the network structure for pluripotent stem cell signaling</p>
<p><a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/ipsc_validation/input_data/expression.csv"><code>expression.csv</code></a> contains the initial activities for ESC cells (3 replicates), and EpiSC cells (3 replicates)</p>
<p><a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/ipsc_validation/input_data/internal-marker-kinoshita.txt"><code>internal-marker-kinoshita.txt</code></a> contains the 4 internal marker nodes that were originally used in Yachie-Kinoshita et al., to evaluate simulations.</p>
<p><a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/ipsc_validation/input_data/internal-marker-kinoshita-expanded.txt"><code>internal-marker-kinoshita-expanded.txt</code></a> contains the 4 internal marker nodes that were originally used in Yachie-Kinoshita et al., plus the additional marker ndoes identified from the data used to evaluate simulations.</p>
<p><a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/ipsc_validation/input_data/samples.txt"><code>samples.txt</code></a> contains they key for NETISCE to associate certain samples to the phenotypes of Embryonic Stem Cells (ESCs) or Epiblast Stem Cells (EpiSCs)</p>
</div>
<div id="run-the-simulation-1" class="section level2">
<h2><span class="header-section-number">6.2</span> Run the simulation</h2>
<p>These simulations were run on a high performance cluster that uses a SLURM executor. If your hpc uses a different executor, please update those specifications in the <code>nextflow.config</code> file in the directory. Please see <a href="https://www.nextflow.io/docs/latest/config.html" class="uri">https://www.nextflow.io/docs/latest/config.html</a> for more information regarding your executor.</p>
<p>For ease of reproduction, we have included all files necessary to reproduce the reported results directly in the <a href="https://github.com/VeraLiconaResearchGroup/Netisce/tree/main/ipsc_validation">directory</a>. We do recommend you run this simulation on an hpc. We have included the <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/ipsc_validation/run.sh">bash file</a> we used on our SLURM executor.</p>
<p><strong>Note: </strong> within the <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/ipsc_validation/NETISCE.nf"><code>NETISCE.nf</code></a> configuration file, we have included two lines for specifying the internal-marker nodes:</p>
<pre><code>#!/usr/bin/env nextflow

params.expressions = &quot;$baseDir/input_data/expression.csv&quot;
params.network = &quot;$baseDir/input_data/network.sif&quot;
params.samples = &quot;$baseDir/input_data/samples.txt&quot;
params.internal_control=&quot;$baseDir/input_data/internal-marker-kinoshita.txt&quot;
// params.internal_control=&quot;$baseDir/input_data/internal-marker-kinoshita-expanded.txt&quot;
params.alpha = 0.9
params.undesired = &#39;EpiSC&#39;
params.desired = &#39;ESC&#39;
params.filter =&quot;strict&quot;</code></pre>
<p>As discussed in our paper, we filtered the perturbations using the original 4 internal-marker nodes for pluripotency (Oct4, Sox2, Nanog, EpiTFs), and then again using 3 additional internal-marker nodes. Therefore, to run either analysis, comment/uncomment the internal-marker node file you are interested in. If you want to run NETISCE first with the original internal-marker nodes, make sure to change the results file names for <code>exp_internalmarkers.txt</code>,<code>successful_controlnode_perturubations.txt</code>, and <code>original-experimental_internalmarkers.pdf</code> as to not overwrite them (or move them into a separate folder). Additionally, when you run the nextflow command, <strong>please be sure to use the <code>-resume</code> flag so that you use the cached computations that do not need to be re-computed</strong></p>
<p>You can also run NETISCE directly using the following command: <code>./nextflow run NETISCE.nf -resume</code></p>
</div>
<div id="results-1" class="section level2">
<h2><span class="header-section-number">6.3</span> Results</h2>
<p>Herein, we will focus on the results that are deposited in the <a href="https://github.com/VeraLiconaResearchGroup/Netisce/tree/main/ipsc_validation/results"><code>results</code></a> folder by NETISCE. However, each step of the nextflow pipeline produces its corresponding raw results (for example, the entire attractor state for network simulations initialized with experimental data). If you are interested in looking at those raw results, they can be found within the <a href="https://github.com/VeraLiconaResearchGroup/Netisce/tree/main/ipsc_validation/work"><code>work</code></a> folder. We provide <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/ipsc_validation/workfiles.txt"><code>workfiles.txt</code></a> which is a guide to which folders/subfolders contain the relevant results of each step.</p>
<div id="general-results" class="section level3">
<h3><span class="header-section-number">6.3.1</span> General Results</h3>
<p>First, let’s take a look at the results that do not depend on the internal-marker node set.</p>
<div id="section-id" class="section level4 unnumbered">
<h4>FVS finding</h4>
The FVS solving algorithm identified one FVS, containing 6 nodes.
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sox2
</td>
</tr>
<tr>
<td style="text-align:left;">
Nanog
</td>
</tr>
<tr>
<td style="text-align:left;">
Gata6
</td>
</tr>
<tr>
<td style="text-align:left;">
Tbx3
</td>
</tr>
<tr>
<td style="text-align:left;">
Oct4
</td>
</tr>
<tr>
<td style="text-align:left;">
Klf4
</td>
</tr>
</tbody>
</table>
</div>
<div id="section-id" class="section level4 unnumbered">
<h4>Attractor landscape estimation via k-means analysis</h4>
<p>Now, let’s look at the results of k-means analysis. First, NETISCE determines the optimal number of k clusters by computing the elbow and silhouette metrics.</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-25"></span>
<img src="ipsc/results/elbow.png" alt="optimal k as identified by a) the elbow and b) silhouette metrics" width="50%" /><img src="ipsc/results/silhouette.png" alt="optimal k as identified by a) the elbow and b) silhouette metrics" width="50%" />
<p class="caption">
Figure 6.1: optimal k as identified by a) the elbow and b) silhouette metrics
</p>
</div>
<p>We see that the optimal k assessed by the elbow metric was k=4, while the optimal k identified by the silhouette metric was k=2. NETISCE automatically chooses the smaller k value, after checking that the attractors generated from the ESC samples and EpiSC samples do not appear in the same cluster.</p>
<p>k=2 was selected for k-means optimal k, and we can see that the attractors generated from the ESC samples and EpiSC samples do not appear in separate clusters.</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:right;">
clusters
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ESC_1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ESC_2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ESC_3
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
EpiSC_1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
EpiSC_2
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
EpiSC_3
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div id="section-id" class="section level4 unnumbered">
<h4>Pertrubations on FVS control nodes that pass criterion 1</h4>
<p>With 6 FVS control nodes, NETISCE performed 729 simulations of combinations of perturbations on the FVS control nodes. The resulting attractors were classified to the clusters produced from the k-means analysis using Naive Bayes, Support Vector Machine, and Random Forest Machine Learning classification algorithms. Then, the perturbations are filtered by which of their corresponding attractors were classified to the ESC cluster by at least 2 of the 3 methods. These results can be found in <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/ipsc_validation/results/crit1perts.txt"><code>crit1_perts.txt</code></a>. Here we show the first 10 rows.</p>
<pre><code>## [1] &quot;number of perturbations that pass filtering criteria 1: 375&quot;</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
pert_8
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_17
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_26
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_35
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_44
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_53
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_88
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_89
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_97
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_98
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="results-using-4-internal-marker-nodes" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Results using 4 internal-marker nodes</h3>
<p><strong>The relevant files have the prefix ‘original’ in the github repository</strong></p>
<p>Our second perturbation filtering criterion identifies perturbations where, in their corresponding attractors, 90% of the steady state values for internal-marker nodes that are within the steady state expression ranges in the attractors generated from the ESC experimental data.</p>
<p>First, let’s take a look at the steady state values of the internal-marker nodes Oct4, Sox2, and Nanog in the attractors generated from the ESC and EpiSC experimental data. The values can be found in the <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/ipsc_validation/results/original-exp_internalmarkers.txt"><code>original-exp_internalmarkers.txt</code></a> and are plotted in <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/ipsc_validation/results/original-experimental_internalmarkers.pdf"><code>original-experimental_internalmarkers.pdf</code></a>:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-28"></span>
<img src="ipsc/results/original-experimental_internalmarkers.pdf" alt="histograms of 4 internal-marker node values" width="460pt" height="700pt" />
<p class="caption">
Figure 6.2: histograms of 4 internal-marker node values
</p>
</div>
<p>We see that the values of the internal-markers for the pluripotent state (Oct4, Sox2, Nanog) are higher in the attractors generated from the experimental data of the ESCs than the attractors generated from the experimental data of the EpiSCs, and the makrer of the epiblast stem state is higher in the attractors generated from the experimental data of the EpiSCs than in the attractors generated from the experimental data of the ESC.</p>
<p>Now, we can take a look at the attractors that passed filtering criterion 2. We show the first 10 rows here, but you can view the entire set in <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/ipsc_validation/results/original-successful_controlnode_perturbations.txt"><code>original-successful_controlnode_perturbations.txt</code></a></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r foldable"><code class="sourceCode r"><span id="cb8-1"><a href="pluripotent-stem-cell-example.html#cb8-1"></a>crit2_<span class="dv">4</span>&lt;-<span class="kw">read.delim</span>(<span class="st">&#39;ipsc/results/original-successful_controlnode_perturbations.txt&#39;</span>,<span class="dt">sep=</span><span class="st">&quot; &quot;</span>,<span class="dt">as.is =</span> T)</span>
<span id="cb8-2"><a href="pluripotent-stem-cell-example.html#cb8-2"></a><span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&#39;number of perturbations that pass filtering criteria 2: &#39;</span>,<span class="kw">nrow</span>(crit2_<span class="dv">4</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;number of perturbations that pass filtering criteria 2: 132&quot;</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r foldable"><code class="sourceCode r"><span id="cb10-1"><a href="pluripotent-stem-cell-example.html#cb10-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(crit2_<span class="dv">4</span>[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,])  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">column_spec</span>(<span class="dv">8</span>, <span class="dt">bold =</span> F, <span class="dt">border_left =</span> T) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">scroll_box</span>(<span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>, <span class="dt">box_css =</span> <span class="st">&quot;border: 0px;&quot;</span>) </span></code></pre></div>
<div style="border: 0px;overflow-x: scroll; width:100%; ">
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Sox2
</th>
<th style="text-align:left;">
Nanog
</th>
<th style="text-align:left;">
Gata6
</th>
<th style="text-align:left;">
Tbx3
</th>
<th style="text-align:left;">
Oct4
</th>
<th style="text-align:left;">
Klf4
</th>
<th style="text-align:right;">
up
</th>
<th style="text-align:right;">
down
</th>
<th style="text-align:right;">
total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
pert_445
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_607
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_368
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:right;border-left:1px solid;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_418
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_436
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_446
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:right;border-left:1px solid;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_448
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_454
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_580
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_598
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
<p>We can look to see if there are any trends in the orientation of the perturbations on FVS control nodes across the perturbations that passed both filtering criteria.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r foldable"><code class="sourceCode r"><span id="cb11-1"><a href="pluripotent-stem-cell-example.html#cb11-1"></a><span class="kw">library</span>(data.table)</span>
<span id="cb11-2"><a href="pluripotent-stem-cell-example.html#cb11-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb11-3"><a href="pluripotent-stem-cell-example.html#cb11-3"></a>d3&lt;-crit2_<span class="dv">4</span> [,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">transpose</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.matrix</span>()</span>
<span id="cb11-4"><a href="pluripotent-stem-cell-example.html#cb11-4"></a><span class="kw">row.names</span>(d3)&lt;-<span class="kw">colnames</span>(crit2_<span class="dv">4</span>[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>])</span>
<span id="cb11-5"><a href="pluripotent-stem-cell-example.html#cb11-5"></a><span class="kw">colnames</span>(d3)&lt;-<span class="kw">row.names</span>(crit2_<span class="dv">4</span>)</span>
<span id="cb11-6"><a href="pluripotent-stem-cell-example.html#cb11-6"></a>d3r&lt;-reshape2<span class="op">::</span><span class="kw">melt</span>(d3) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>Var2)</span>
<span id="cb11-7"><a href="pluripotent-stem-cell-example.html#cb11-7"></a></span>
<span id="cb11-8"><a href="pluripotent-stem-cell-example.html#cb11-8"></a><span class="co">#From Paul Tol: https://personal.sron.nl/~pault/</span></span>
<span id="cb11-9"><a href="pluripotent-stem-cell-example.html#cb11-9"></a>Tol_muted &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;#88CCEE&#39;</span>, <span class="st">&#39;#44AA99&#39;</span>, <span class="st">&#39;#117733&#39;</span>, <span class="st">&#39;#332288&#39;</span>, <span class="st">&#39;#DDCC77&#39;</span>, <span class="st">&#39;#999933&#39;</span>,<span class="st">&#39;#CC6677&#39;</span>, <span class="st">&#39;#882255&#39;</span>, <span class="st">&#39;#AA4499&#39;</span>, <span class="st">&#39;#DDDDDD&#39;</span>)</span>
<span id="cb11-10"><a href="pluripotent-stem-cell-example.html#cb11-10"></a></span>
<span id="cb11-11"><a href="pluripotent-stem-cell-example.html#cb11-11"></a><span class="kw">ggplot</span>(d3r, <span class="kw">aes</span>(<span class="dt">x=</span>value)) <span class="op">+</span></span>
<span id="cb11-12"><a href="pluripotent-stem-cell-example.html#cb11-12"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Var1,<span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>,<span class="dt">shrink=</span><span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb11-13"><a href="pluripotent-stem-cell-example.html#cb11-13"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> (..count..)<span class="op">/</span><span class="kw">ncol</span>(d3),<span class="dt">fill=</span>value))  <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels=</span>scales<span class="op">::</span>percent) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>Tol_muted)<span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;% of specified perturbation to an FVS control node across all </span><span class="ch">\n</span><span class="st"> combinations of perturbations that passed filtering criteria &quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;node perturbation&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-1.png" width="672" style="display: block; margin: auto;" />
Here, we see that in the majority of perturbations, there is overexpression of the FVS nodes Sox2, Nanog and Oct4. This aligns with their role as maintainers of pluripotency.</p>
<p>The steady-state values of the internal-marker nodes for these perturbations can be found in <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/ipsc_validation/results/pert1_internal_markers.txt"><code>pert1_internal_markers.txt</code></a>.</p>
<p>A perturbation on the FVS control node, Nanog overexpression (pert_445), was also identified in Yachie-Kinoshita et al. and experimentally verified to shift cells from the EpiSC state towards the ESC state. We can plot the internal-marker node values using a radar plot.</p>
<p>We can also plot Klf4 overexpression. This was a perturbation identified by Yachie-Kinoshita et al. to shift cells from the EpiSC state towards the ESC state. However, in our analyses, this perturbation (pert_365), did pass filtering criterion 1, but did not pass filtering criterion 2.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r foldable"><code class="sourceCode r"><span id="cb12-1"><a href="pluripotent-stem-cell-example.html#cb12-1"></a><span class="kw">library</span>(fmsb)</span>
<span id="cb12-2"><a href="pluripotent-stem-cell-example.html#cb12-2"></a>attr_pert&lt;-<span class="kw">read.delim</span>(<span class="st">&quot;ipsc/results/pert1_internal_markers.txt&quot;</span>,<span class="dt">sep=</span><span class="st">&quot; &quot;</span>,<span class="dt">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb12-3"><a href="pluripotent-stem-cell-example.html#cb12-3"></a>attr_pert &lt;-attr_pert[<span class="kw">c</span>(<span class="st">&#39;pert_445&#39;</span>,<span class="st">&#39;pert_365&#39;</span>),<span class="kw">c</span>(<span class="st">&#39;Oct4&#39;</span>,<span class="st">&quot;Sox2&quot;</span>,<span class="st">&quot;Nanog&quot;</span>,<span class="st">&quot;EpiTFs&quot;</span>)]</span>
<span id="cb12-4"><a href="pluripotent-stem-cell-example.html#cb12-4"></a>exp&lt;-<span class="kw">read.delim</span>(<span class="st">&quot;ipsc/results/original-exp_internalmarkers.txt&quot;</span>,<span class="dt">sep=</span><span class="st">&quot; &quot;</span>,<span class="dt">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb12-5"><a href="pluripotent-stem-cell-example.html#cb12-5"></a>EpiSC_avg&lt;-<span class="kw">colMeans</span>(exp[<span class="dv">4</span><span class="op">:</span><span class="dv">6</span>,])</span>
<span id="cb12-6"><a href="pluripotent-stem-cell-example.html#cb12-6"></a>ESC_avg&lt;-<span class="kw">colMeans</span>(exp[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,])</span>
<span id="cb12-7"><a href="pluripotent-stem-cell-example.html#cb12-7"></a></span>
<span id="cb12-8"><a href="pluripotent-stem-cell-example.html#cb12-8"></a>d1&lt;-<span class="kw">rbind</span>(EpiSC_avg,ESC_avg,attr_pert)</span>
<span id="cb12-9"><a href="pluripotent-stem-cell-example.html#cb12-9"></a><span class="kw">rownames</span>(d1)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;EpiSC&quot;</span>, <span class="st">&quot;ESC&quot;</span>,<span class="st">&quot;Nanog overexpression&quot;</span>,<span class="st">&quot;Klf4 overexpression&quot;</span>)</span>
<span id="cb12-10"><a href="pluripotent-stem-cell-example.html#cb12-10"></a>maxcol&lt;-<span class="kw">apply</span>(d1, <span class="dv">2</span>, max)</span>
<span id="cb12-11"><a href="pluripotent-stem-cell-example.html#cb12-11"></a>mincol&lt;-<span class="kw">apply</span>(d1, <span class="dv">2</span>, min)</span>
<span id="cb12-12"><a href="pluripotent-stem-cell-example.html#cb12-12"></a></span>
<span id="cb12-13"><a href="pluripotent-stem-cell-example.html#cb12-13"></a>d2&lt;-<span class="kw">rbind</span>(maxcol,mincol, d1)</span>
<span id="cb12-14"><a href="pluripotent-stem-cell-example.html#cb12-14"></a><span class="kw">rownames</span>(d2)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Max&quot;</span>, <span class="st">&quot;Min&quot;</span>)</span>
<span id="cb12-15"><a href="pluripotent-stem-cell-example.html#cb12-15"></a></span>
<span id="cb12-16"><a href="pluripotent-stem-cell-example.html#cb12-16"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="fl">0.1</span>, <span class="dv">4</span>, <span class="fl">0.1</span>))</span>
<span id="cb12-17"><a href="pluripotent-stem-cell-example.html#cb12-17"></a></span>
<span id="cb12-18"><a href="pluripotent-stem-cell-example.html#cb12-18"></a></span>
<span id="cb12-19"><a href="pluripotent-stem-cell-example.html#cb12-19"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">5</span><span class="op">:</span><span class="kw">nrow</span>(d2)) {</span>
<span id="cb12-20"><a href="pluripotent-stem-cell-example.html#cb12-20"></a>  <span class="kw">create_beautiful_radarchart</span>(d2[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, i), ],<span class="dt">color =</span> <span class="kw">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>,<span class="st">&quot;#FC4E07&quot;</span>),<span class="dt">caxislabels =</span> <span class="kw">seq</span>(<span class="kw">round</span>(<span class="kw">min</span>(d2[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, i),]),<span class="dv">1</span>),<span class="kw">round</span>(<span class="kw">max</span>(d2[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, i),]),<span class="dv">1</span>),.<span class="dv">2</span>),<span class="dt">title =</span><span class="kw">row.names</span>(d2)[i]);<span class="kw">legend</span>(<span class="dt">x=</span><span class="fl">0.4</span>, <span class="dt">y=</span><span class="fl">1.4</span>, <span class="dt">legend =</span><span class="kw">c</span>(<span class="st">&quot;average EpiSC&quot;</span>,<span class="st">&quot;average ESC&quot;</span>,<span class="kw">row.names</span>(d2)[i]) , <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span> , <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>,<span class="st">&quot;#FC4E07&quot;</span>) , <span class="dt">text.col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">pt.cex=</span><span class="dv">2</span>)</span>
<span id="cb12-21"><a href="pluripotent-stem-cell-example.html#cb12-21"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:ipsc-charts"></span>
<img src="_main_files/figure-html/ipsc-charts-1.png" alt="radar charts of the steady-state values of 4 internal-marker nodes for Nanog overexpression and Klf4 overexpression perturbation" width="50%" /><img src="_main_files/figure-html/ipsc-charts-2.png" alt="radar charts of the steady-state values of 4 internal-marker nodes for Nanog overexpression and Klf4 overexpression perturbation" width="50%" />
<p class="caption">
Figure 6.3: radar charts of the steady-state values of 4 internal-marker nodes for Nanog overexpression and Klf4 overexpression perturbation
</p>
</div>
<p>We see here, indeed that the values for Oct4, Sox2, Nanog, (when considered these three genes as internal-marker nodes) and EpiTFs are within the expected range for Nanog overexpression, but the values of Oct4, Sox2, Nanog in the attractor generated from Klf4 overexpression do not reach the values of the ESC state.</p>
</div>
<div id="results-using-7-internal-marker-nodes" class="section level3">
<h3><span class="header-section-number">6.3.3</span> Results using 7 internal-marker nodes</h3>
<p><em>The relevant files have the prefix ‘expanded’ in the github repository.</em></p>
<p>We explored filtering the 132 perturbations that passed the second filtering criterion by adding additional internal-marker nodes associated with pluripotency. We added 3 nodes, Lefty1, Pitx2 (transcription factors active in EpiSCs), and Esrrb (transcription factor active in ESCs) to the 4 previously used internal-marker nodes.</p>
<p>Let’s look at the steady state values of the internal-marker nodes in the attractors generated from the ESC and EpiSC experimental data. The values can be found in the <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/ipsc_validation/results/expanded-exp_internalmarkers.txt"><code>expanded-exp_internalmarkers.txt</code></a> and are plotted in <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/ipsc_validation/results/expanded-experimental_internalmarkers.pdf"><code>expanded-experimental_internalmarkers.pdf</code></a>:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-31"></span>
<img src="ipsc/results/expanded-experimental_internalmarkers.pdf" alt="histograms of 7 internal-marker node values" width="460pt" height="700pt" />
<p class="caption">
Figure 6.4: histograms of 7 internal-marker node values
</p>
</div>
<p>Again, the internal-marker nodes have the correct expression patterns within the attractors generated from the ESC and EpiSC states.</p>
<p>Now, we can take a look at the attractors that passed filtering criterion 2. These are in file <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/ipsc_validation/results/expanded-successful_controlnode_perturbations.txt"><code>expanded-successful_controlnode_perturbations.txt</code></a></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r foldable"><code class="sourceCode r"><span id="cb13-1"><a href="pluripotent-stem-cell-example.html#cb13-1"></a>crit2_<span class="dv">7</span>&lt;-<span class="kw">read.delim</span>(<span class="st">&#39;ipsc/results/expanded-successful_controlnode_perturbations.txt&#39;</span>,<span class="dt">sep=</span><span class="st">&quot; &quot;</span>)</span>
<span id="cb13-2"><a href="pluripotent-stem-cell-example.html#cb13-2"></a><span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&#39;number of perturbations that pass filtering criteria 2: &#39;</span>,<span class="kw">nrow</span>(crit2_<span class="dv">7</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;number of perturbations that pass filtering criteria 2: 15&quot;</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r foldable"><code class="sourceCode r"><span id="cb15-1"><a href="pluripotent-stem-cell-example.html#cb15-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(crit2_<span class="dv">7</span>)  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">column_spec</span>(<span class="dv">8</span>, <span class="dt">bold =</span> F, <span class="dt">border_left =</span> T) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">scroll_box</span>(<span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>, <span class="dt">box_css =</span> <span class="st">&quot;border: 0px;&quot;</span>)</span></code></pre></div>
<div style="border: 0px;overflow-x: scroll; width:100%; ">
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Sox2
</th>
<th style="text-align:left;">
Nanog
</th>
<th style="text-align:left;">
Gata6
</th>
<th style="text-align:left;">
Tbx3
</th>
<th style="text-align:left;">
Oct4
</th>
<th style="text-align:left;">
Klf4
</th>
<th style="text-align:right;">
up
</th>
<th style="text-align:right;">
down
</th>
<th style="text-align:right;">
total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
pert_445
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_418
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_436
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_446
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:right;border-left:1px solid;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_454
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_409
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_419
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:right;border-left:1px solid;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_427
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:right;border-left:1px solid;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_437
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:right;border-left:1px solid;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_455
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:right;border-left:1px solid;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_473
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:right;border-left:1px solid;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_410
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:right;border-left:1px solid;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_428
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:right;border-left:1px solid;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_464
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
down
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:right;border-left:1px solid;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
pert_482
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:left;">
nochange
</td>
<td style="text-align:left;">
up
</td>
<td style="text-align:right;border-left:1px solid;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
</tr>
</tbody>
</table>
</div>
<p>We can plot the trends of the orientation of perturbations for each FVS control node across the 15 perturbations.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r foldable"><code class="sourceCode r"><span id="cb16-1"><a href="pluripotent-stem-cell-example.html#cb16-1"></a>d4&lt;-crit2_<span class="dv">7</span> [,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">transpose</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.matrix</span>()</span>
<span id="cb16-2"><a href="pluripotent-stem-cell-example.html#cb16-2"></a><span class="kw">row.names</span>(d4)&lt;-<span class="kw">colnames</span>(crit2_<span class="dv">7</span>[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>])</span>
<span id="cb16-3"><a href="pluripotent-stem-cell-example.html#cb16-3"></a><span class="kw">colnames</span>(d4)&lt;-<span class="kw">row.names</span>(crit2_<span class="dv">7</span>)</span>
<span id="cb16-4"><a href="pluripotent-stem-cell-example.html#cb16-4"></a>d4r&lt;-reshape2<span class="op">::</span><span class="kw">melt</span>(d4) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>Var2)</span>
<span id="cb16-5"><a href="pluripotent-stem-cell-example.html#cb16-5"></a></span>
<span id="cb16-6"><a href="pluripotent-stem-cell-example.html#cb16-6"></a></span>
<span id="cb16-7"><a href="pluripotent-stem-cell-example.html#cb16-7"></a></span>
<span id="cb16-8"><a href="pluripotent-stem-cell-example.html#cb16-8"></a><span class="kw">ggplot</span>(d4r, <span class="kw">aes</span>(<span class="dt">x=</span>value)) <span class="op">+</span></span>
<span id="cb16-9"><a href="pluripotent-stem-cell-example.html#cb16-9"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Var1,<span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>,<span class="dt">shrink=</span><span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb16-10"><a href="pluripotent-stem-cell-example.html#cb16-10"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> (..count..)<span class="op">/</span><span class="kw">ncol</span>(d4),<span class="dt">fill=</span>value))  <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels=</span>scales<span class="op">::</span>percent) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>Tol_muted) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;% of specified perturbation to an FVS control node across all </span><span class="ch">\n</span><span class="st"> combinations of perturbations that passed filtering criteria &quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;node perturbation&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="672" style="display: block; margin: auto;" />
Interestingly, we see among these 15 perturbations, Nanog overexpression, but no change to Oct4 or Sox2, is indicated. We also see that Klf4 is overexpressed in the majority of these 15 perturbations.</p>
<p>The steady-state values of the internal-marker nodes for these perturbations can be found in <a href="https://github.com/VeraLiconaResearchGroup/Netisce/blob/main/ipsc_validation/results/pert1_internal_markers.txt"><code>pert1_internal_markers.txt</code></a>.</p>
<p>We can also generate radar plots for these 15 perturbations.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r foldable"><code class="sourceCode r"><span id="cb17-1"><a href="pluripotent-stem-cell-example.html#cb17-1"></a><span class="kw">library</span>(fmsb)</span>
<span id="cb17-2"><a href="pluripotent-stem-cell-example.html#cb17-2"></a>attr_pert&lt;-<span class="kw">read.delim</span>(<span class="st">&quot;ipsc/results/pert1_internal_markers.txt&quot;</span>,<span class="dt">sep=</span><span class="st">&quot; &quot;</span>,<span class="dt">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb17-3"><a href="pluripotent-stem-cell-example.html#cb17-3"></a>attr_pert &lt;-attr_pert[<span class="kw">row.names</span>(crit2_<span class="dv">7</span>),]</span>
<span id="cb17-4"><a href="pluripotent-stem-cell-example.html#cb17-4"></a>exp&lt;-<span class="kw">read.delim</span>(<span class="st">&quot;ipsc/results/expanded-exp_internalmarkers.txt&quot;</span>,<span class="dt">sep=</span><span class="st">&quot; &quot;</span>,<span class="dt">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb17-5"><a href="pluripotent-stem-cell-example.html#cb17-5"></a>EpiSC_avg&lt;-<span class="kw">colMeans</span>(exp[<span class="dv">4</span><span class="op">:</span><span class="dv">6</span>,])</span>
<span id="cb17-6"><a href="pluripotent-stem-cell-example.html#cb17-6"></a>ESC_avg&lt;-<span class="kw">colMeans</span>(exp[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,])</span>
<span id="cb17-7"><a href="pluripotent-stem-cell-example.html#cb17-7"></a></span>
<span id="cb17-8"><a href="pluripotent-stem-cell-example.html#cb17-8"></a>d1&lt;-<span class="kw">rbind</span>(EpiSC_avg,ESC_avg,attr_pert)</span>
<span id="cb17-9"><a href="pluripotent-stem-cell-example.html#cb17-9"></a><span class="kw">rownames</span>(d1)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;EpiSC&quot;</span>, <span class="st">&quot;ESC&quot;</span>)</span>
<span id="cb17-10"><a href="pluripotent-stem-cell-example.html#cb17-10"></a>maxcol&lt;-<span class="kw">apply</span>(d1, <span class="dv">2</span>, max)</span>
<span id="cb17-11"><a href="pluripotent-stem-cell-example.html#cb17-11"></a>mincol&lt;-<span class="kw">apply</span>(d1, <span class="dv">2</span>, min)</span>
<span id="cb17-12"><a href="pluripotent-stem-cell-example.html#cb17-12"></a></span>
<span id="cb17-13"><a href="pluripotent-stem-cell-example.html#cb17-13"></a>d2&lt;-<span class="kw">rbind</span>(maxcol,mincol, d1)</span>
<span id="cb17-14"><a href="pluripotent-stem-cell-example.html#cb17-14"></a><span class="kw">rownames</span>(d2)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Max&quot;</span>, <span class="st">&quot;Min&quot;</span>)</span>
<span id="cb17-15"><a href="pluripotent-stem-cell-example.html#cb17-15"></a></span>
<span id="cb17-16"><a href="pluripotent-stem-cell-example.html#cb17-16"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="fl">0.1</span>, <span class="dv">4</span>, <span class="fl">0.1</span>))</span>
<span id="cb17-17"><a href="pluripotent-stem-cell-example.html#cb17-17"></a></span>
<span id="cb17-18"><a href="pluripotent-stem-cell-example.html#cb17-18"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">5</span><span class="op">:</span><span class="kw">nrow</span>(d2)) {</span>
<span id="cb17-19"><a href="pluripotent-stem-cell-example.html#cb17-19"></a>  <span class="kw">create_beautiful_radarchart</span>(d2[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, i), ],<span class="dt">color =</span> <span class="kw">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>,<span class="st">&quot;#FC4E07&quot;</span>),<span class="dt">caxislabels =</span> <span class="kw">seq</span>(<span class="kw">round</span>(<span class="kw">min</span>(d2[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, i),]),<span class="dv">1</span>),<span class="kw">round</span>(<span class="kw">max</span>(d2[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, i),]),<span class="dv">1</span>),.<span class="dv">2</span>),<span class="dt">title =</span><span class="kw">row.names</span>(d2)[i]);<span class="kw">legend</span>(<span class="dt">x=</span><span class="fl">0.4</span>, <span class="dt">y=</span><span class="fl">1.4</span>, <span class="dt">legend =</span><span class="kw">c</span>(<span class="st">&quot;average EpiSC&quot;</span>,<span class="st">&quot;average ESC&quot;</span>,<span class="kw">row.names</span>(d2)[i]) , <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span> , <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>,<span class="st">&quot;#FC4E07&quot;</span>) , <span class="dt">text.col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">pt.cex=</span><span class="dv">2</span>)</span>
<span id="cb17-20"><a href="pluripotent-stem-cell-example.html#cb17-20"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:ipsc-charts2"></span>
<img src="_main_files/figure-html/ipsc-charts2-1.png" alt="radar charts of the steady-state values of 7 internal-marker nodes perturbation" width="50%" /><img src="_main_files/figure-html/ipsc-charts2-2.png" alt="radar charts of the steady-state values of 7 internal-marker nodes perturbation" width="50%" /><img src="_main_files/figure-html/ipsc-charts2-3.png" alt="radar charts of the steady-state values of 7 internal-marker nodes perturbation" width="50%" /><img src="_main_files/figure-html/ipsc-charts2-4.png" alt="radar charts of the steady-state values of 7 internal-marker nodes perturbation" width="50%" /><img src="_main_files/figure-html/ipsc-charts2-5.png" alt="radar charts of the steady-state values of 7 internal-marker nodes perturbation" width="50%" /><img src="_main_files/figure-html/ipsc-charts2-6.png" alt="radar charts of the steady-state values of 7 internal-marker nodes perturbation" width="50%" /><img src="_main_files/figure-html/ipsc-charts2-7.png" alt="radar charts of the steady-state values of 7 internal-marker nodes perturbation" width="50%" /><img src="_main_files/figure-html/ipsc-charts2-8.png" alt="radar charts of the steady-state values of 7 internal-marker nodes perturbation" width="50%" /><img src="_main_files/figure-html/ipsc-charts2-9.png" alt="radar charts of the steady-state values of 7 internal-marker nodes perturbation" width="50%" /><img src="_main_files/figure-html/ipsc-charts2-10.png" alt="radar charts of the steady-state values of 7 internal-marker nodes perturbation" width="50%" /><img src="_main_files/figure-html/ipsc-charts2-11.png" alt="radar charts of the steady-state values of 7 internal-marker nodes perturbation" width="50%" /><img src="_main_files/figure-html/ipsc-charts2-12.png" alt="radar charts of the steady-state values of 7 internal-marker nodes perturbation" width="50%" /><img src="_main_files/figure-html/ipsc-charts2-13.png" alt="radar charts of the steady-state values of 7 internal-marker nodes perturbation" width="50%" /><img src="_main_files/figure-html/ipsc-charts2-14.png" alt="radar charts of the steady-state values of 7 internal-marker nodes perturbation" width="50%" /><img src="_main_files/figure-html/ipsc-charts2-15.png" alt="radar charts of the steady-state values of 7 internal-marker nodes perturbation" width="50%" />
<p class="caption">
Figure 6.5: radar charts of the steady-state values of 7 internal-marker nodes perturbation
</p>
</div>
<p>These radar plots show that for all 15 perturbations on FVS control nodes, the steady-state values of the internal-marker nodes are within the expression range of the attractors generated from the ESC experimental data.</p>
<!-- ```{r radar-plots-for-paper, echo=FALSE,  fig.show='hold', out.width='50%'} -->
<!-- attr_pert<-read.delim("ipsc/results/pert1_internal_markers.txt",sep=" ",row.names = 1) -->
<!-- attr_pert <-attr_pert[c('pert_445','pert_365'),c('Oct4',"Sox2","Nanog","EpiTFs")] -->
<!-- exp<-read.delim("ipsc/results/original-exp_internalmarkers.txt",sep=" ",row.names = 1) -->
<!-- EpiSC_avg<-colMeans(exp[4:6,]) -->
<!-- ESC_avg<-colMeans(exp[1:3,]) -->
<!-- d1<-rbind(EpiSC_avg,ESC_avg,attr_pert) -->
<!-- rownames(d1)[1:4]<- c("EpiSC", "ESC","Nanog overexpression","Klf4 overexpression") -->
<!-- maxcol<-apply(d1, 2, max) -->
<!-- mincol<-apply(d1, 2, min) -->
<!-- d2<-rbind(maxcol,mincol, d1) -->
<!-- rownames(d2)[1:2]<- c("Max", "Min") -->
<!-- par(mar = c(4, 0.1, 4, 0.1)) -->
<!-- for (i in 5:nrow(d2)) { -->
<!--   create_beautiful_radarchart(d2[c(1:4, i), ],color = c("#00AFBB", "#E7B800","#FC4E07"),caxislabels = seq(round(min(d2[c(1:4, i),]),1),round(max(d2[c(1:4, i),]),1),.2),title =row.names(d2)[i]);legend(x=0.4, y=1.4, legend =c("average EpiSC","average ESC",row.names(d2)[i]) , bty = "n", pch=20 , col=c("#00AFBB", "#E7B800","#FC4E07") , text.col = "black", cex=1, pt.cex=2) -->
<!-- } -->
<!-- ``` -->
<!-- ```{r radar-plots-for-paper2, echo=FALSE,  fig.show='hold', out.width='33%'} -->
<!-- attr_pert<-read.delim("ipsc/results/pert1_internal_markers.txt",sep=" ",row.names = 1) -->
<!-- attr_pert <-attr_pert[c('pert_445','pert_365','pert_446'),] -->
<!-- exp<-read.delim("ipsc/results/expanded-exp_internalmarkers.txt",sep=" ",row.names = 1) -->
<!-- EpiSC_avg<-colMeans(exp[4:6,]) -->
<!-- ESC_avg<-colMeans(exp[1:3,]) -->
<!-- d1<-rbind(EpiSC_avg,ESC_avg,attr_pert) -->
<!-- rownames(d1)[1:5]<- c("EpiSC", "ESC","Nanog overexpression","Klf4 overexpression","Nanog+Klf4 overexpression") -->
<!-- maxcol<-apply(d1, 2, max) -->
<!-- mincol<-apply(d1, 2, min) -->
<!-- d2<-rbind(maxcol,mincol, d1) -->
<!-- rownames(d2)[1:2]<- c("Max", "Min") -->
<!-- par(mar = c(4, 0.1, 4, 0.1)) -->
<!-- for (i in 5:nrow(d2)) { -->
<!--   create_beautiful_radarchart(d2[c(1:4, i), ],color = c("#00AFBB", "#E7B800","#FC4E07"),caxislabels = seq(round(min(d2[c(1:4, i),]),1),round(max(d2[c(1:4, i),]),1),.2),title =row.names(d2)[i]);legend(x=0.4, y=1.4, legend =c("average EpiSC","average ESC",row.names(d2)[i]) , bty = "n", pch=20 , col=c("#00AFBB", "#E7B800","#FC4E07") , text.col = "black", cex=.8, pt.cex=1.8) -->
<!-- } -->
<!-- ``` -->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cell-fate-specification-in-ascidian-embryo.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="adaptive-resistance-in-colorectal-cancer-example.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/VeraLiconaResearchGroup/Netisce/tree/gh-pages/05-ipsc.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
